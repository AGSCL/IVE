<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Andrés González Santa Cruz">
<meta name="dcterms.date" content="2023-09-24">
<meta name="description" content="Resumen de datos para exportar a revista">

<title>Paso 4</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Paso4_files/libs/clipboard/clipboard.min.js"></script>
<script src="Paso4_files/libs/quarto-html/quarto.js"></script>
<script src="Paso4_files/libs/quarto-html/popper.min.js"></script>
<script src="Paso4_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Paso4_files/libs/quarto-html/anchor.min.js"></script>
<link href="Paso4_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Paso4_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Paso4_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Paso4_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Paso4_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="Paso4_files/libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="Paso4_files/libs/plotly-binding-4.10.2/plotly.js"></script>
<script src="Paso4_files/libs/typedarray-0.1/typedarray.min.js"></script>
<script src="Paso4_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="Paso4_files/libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="Paso4_files/libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="Paso4_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="Paso4_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="Paso4_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="Paso4_files/libs/datatables-binding-0.29/datatables.js"></script>
<link href="Paso4_files/libs/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="Paso4_files/libs/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="Paso4_files/libs/dt-core-1.13.4/js/jquery.dataTables.min.js"></script>
<link href="Paso4_files/libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="Paso4_files/libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="Paso4_files/libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="Paso4_files/libs/selectize-0.12.0/selectize.min.js"></script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Paso 4</h1>
</div>

<div>
  <div class="description">
    <p>Resumen de datos para exportar a revista</p>
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Andrés González Santa Cruz </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 24, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">
<style type="text/css">
script src = "https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"

</style>
</div>
<div class="cell">
<script>
$(document).ready(function() {

$('body').prepend('<div class=\"zoomDiv\"><img src=\"\" class=\"zoomImg\"></div>');

// onClick function for all plots (img's)

$('img:not(.zoomImg)').click(function() {
$('.zoomImg').attr('src', $(this).attr('src')).css({width: '100%'});
$('.zoomDiv').css({opacity: '1', width: 'auto', border: '1px solid white', borderRadius: '5px', position: 'fixed', top: '50%', left: '50%', marginRight: '-50%', transform: 'translate(-50%, -50%)', boxShadow: '0px 0px 50px #888888', zIndex: '50', overflow: 'auto', maxHeight: '100%'});
});

// onClick function for zoomImg

$('img.zoomImg').click(function() {
$('.zoomDiv').css({opacity: '0', width: '0%'});
});
});
</script>
</div>
<div class="cell">
<style type="text/css">
<script src="hideOutput.js"></script>
</style>
</div>
<div class="cell">
<script>
$(document).ready(function() {

\$chunks = \$('.fold');

\$chunks.each(function () { // add button to source code chunks
if ( \$(this).hasClass('s') ) {
    \$('pre.r', this).prepend("\<div class=\\"showopt\\"\>Show Source\</div\>\<br style=\\"line-height:22px;\\"/\>");
    \$('pre.r', this).children('code').attr('class', 'folded');
    } // add button to output chunks

    if ( \$(this).hasClass('o') ) {
        \$('pre:not(.r)', this).has('code').prepend("\<div class=\\"showopt\\"\>Show Output\</div\>\<br style=\\"line-height:22px;\\"/\>");
        \$('pre:not(.r)', this).children('code:not(r)').addClass('folded'); // add button to plots
        \$(this).find('img').wrap('\<pre class=\\"plot\\"\>\</pre\>');
        \$('pre.plot', this).prepend("\<div class=\\"showopt\\"\>Show Plot\</div\>\<br style=\\"line-height:22px;\\"/\>");
        \$('pre.plot', this).children('img').addClass('folded');
        }
}); // hide all chunks when document is loaded

\$('.folded').css('display', 'none') // function to toggle the visibility
\$('.showopt').click(function() {
        var label = \$(this).html();
        if (label.indexOf("Show") \>= 0) {
            \$(this).html(label.replace("Show", "Hide"));
        } else {
        \$(this).html(label.replace("Hide", "Show"));
        }

\$(this).siblings('code, img').slideToggle('fast', 'swing');
});
});
</script>
</div>

<style type="text/css">

.showopt {

background-color: #004c93; color: #FFFFFF; width: 100px; height: 20px; text-align: center; vertical-align: middle !important; float: right; font-family: sans-serif; border-radius: 8px;

}

.showopt:hover {
background-color: #dfe4f2;
color: #004c93;

}

pre.plot {
background-color: white !important;
}

.tablelines table, .tablelines td, .tablelines th {
border: 1px solid black;
}

.centrado {
text-align: center;
}

.table.center {
margin-left:auto;
margin-right:auto;
}

/* https://vivekjaiskumar.medium.com/css-is-and-not-selector-17c942ec83f :is()*/

/* Applies to outputs that are not code other than R*/

pre {
overflow-x: auto !important;
}

pre code {
word-wrap: normal !important;
white-space: pre !important;
}

/*
pre:not(.sourceCode) {
white-space: nowrap !important;
}
*/
.sourceCode { /* Important gives precedence */
font-size: 10px !important;
line-height: 50% !important;
}
body{ /* Normal */
text-align: justify;
}
.superbigimage{
overflow-y:scroll;
height:350px;
white-space: nowrap;
overflow-x: auto;
width:100%;
}
.superbigimage img{
overflow-y: scroll;
overflow-x: hidden;
}
.message { color:#446C6E; font-family: monospace;font-size: 10px; line-height: 110%; font-weight: bold;}
div.blue { background-color:#e6f0ff; border-radius: 5px; padding: 5px; text-align: justify;}
div.red { background-color:#e6bab1; border-radius: 5px; padding: 5px; text-align: justify;}
.pandoc-table { /* Should add !important; but it seems no necessary */
margin-left:auto; /* To center */
margin-right:auto;
border-collapse: collapse;
table-layout: auto;
font-size: 11px;
overflow-y: auto;
max-height:450px !important;
white-space: nowrap;
overflow-x: auto;
width:450px;
}
.pandoc-table th {/* header */
text-align: center !important;
font-size: 10px;
padding: 0px;
}
.pandoc-table td {
text-align: left !important;
font-size: 9px;
padding: 0px;
}
.pandoc-table caption {
text-align: left !important;
font-size: 11px !important;
}

.center-table {
text-align: left !important;
font-size: 9px;
padding: 0px;
overflow-y:scroll;
height:400px;
overflow-x: scroll;
}

.controlly{
overflow-y:scroll;
height:350px;
overflow-x: scroll;

}
</style>
<!-- We gotta do each function to hide code and outputs per section, by every ID, we gotta create a different function -->

<script>
function myFunction1() {
var x = document.getElementById("myDIV");
if (x.style.display === "none") {
x.style.display = "block";
} else {
x.style.display = "none";
}
}
</script>

<script>
function myFunction2() {
var x = document.getElementById("myDIV2");
if (x.style.display === "none") {
x.style.display = "block";
} else {
x.style.display = "none";
}
}
</script>
<section id="cargar-paquetes" class="level1">
<h1>Cargar paquetes</h1>
<p>Cargar bases de datos</p>
<div class="cell" data-layout-align="center" data-paged.print="true">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DiagrammeR) <span class="co">#⋉</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>gr_lca2<span class="ot">&lt;-</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>DiagrammeR<span class="sc">::</span><span class="fu">grViz</span>(<span class="st">"</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="st">digraph flowchart {</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="st">    fontname='Comic Sans MS'</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="st">  # Nodes</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="st">  subgraph samelevel {</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="st">    CAUSAL [label = 'Causal',fontsize=10,shape = box]</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="st">    EDAD_MUJER_REC [label = 'Edad</span><span class="sc">\n</span><span class="st">persona</span><span class="sc">\n</span><span class="st">gestante',fontsize=10,shape = box]</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="st">    HITO1_EDAD_GEST_SEM_REC [label = 'Edad</span><span class="sc">\n</span><span class="st">Gestacional</span><span class="sc">\n</span><span class="st">Hito 1',fontsize=10,shape = box]</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="st">    MACROZONA [label = 'Macrozona',fontsize=10,shape = box]</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="st">    PAIS_ORIGEN_REC [label = 'País de</span><span class="sc">\n</span><span class="st">origen',fontsize=10,shape = box]</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="st">    PREV_TRAMO_REC [label = 'Previsión y</span><span class="sc">\n</span><span class="st">tramo',fontsize=10,shape = box]</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="st">  {rank=same; rankdir= 'TB'; CAUSAL EDAD_MUJER_REC HITO1_EDAD_GEST_SEM_REC MACROZONA PAIS_ORIGEN_REC PREV_TRAMO_REC }</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="st">  LCA [label= 'Clases</span><span class="sc">\n</span><span class="st">latentes', shape= circle, style=filled, color=lightgrey, fontsize=10]</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="st">  inter [label = 'Interupción</span><span class="sc">\n</span><span class="st">embarazo',fontsize=10,shape = box, height=.00002] # set the position of the inter node pos='15,100'</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="st">  # Nodes</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="st">  subgraph {</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="st">   LCA -&gt;  {CAUSAL EDAD_MUJER_REC HITO1_EDAD_GEST_SEM_REC MACROZONA PAIS_ORIGEN_REC PREV_TRAMO_REC } [rank=same; rankdir= 'TB'] </span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="st">  subgraph {</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="st">   LCA -&gt; inter [minlen=14] #minlen es necesario para correr arrowhead = none; </span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="st">  {rank=same; LCA inter [rankdir='LR']}; #; </span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="st">}"</span>)<span class="co">#, width = 1200, height = 900</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="co">#https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3733703/</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co">#Cohort matching on a variable associated with both outcome and censoring</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="co">#Cohort matching on a confounder. We let A denote an exposure, Y denote an outcome, and C denote a confounder and matching variable. The variable S indicates whether an individual in the source population is selected for the matched study (1: selected, 0: not selected). See Section 2-7 for details.</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co">#https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7064555/</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>DPI <span class="ot">=</span> <span class="dv">1200</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>WidthCM <span class="ot">=</span> <span class="dv">21</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>HeightCM <span class="ot">=</span> <span class="dv">8</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>gr_lca2 <span class="sc">%&gt;%</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  export_svg <span class="sc">%&gt;%</span> charToRaw <span class="sc">%&gt;%</span> rsvg<span class="sc">::</span><span class="fu">rsvg_pdf</span>(<span class="st">"_flowchart_lca_adj_sin_po_ano.pdf"</span>)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>gr_lca2 <span class="sc">%&gt;%</span> <span class="fu">export_svg</span>()<span class="sc">%&gt;%</span>charToRaw <span class="sc">%&gt;%</span> <span class="fu">rsvg</span>(<span class="at">width =</span> WidthCM <span class="sc">*</span>(DPI<span class="sc">/</span><span class="fl">2.54</span>), <span class="at">height =</span> HeightCM <span class="sc">*</span>(DPI<span class="sc">/</span><span class="fl">2.54</span>)) <span class="sc">%&gt;%</span> png<span class="sc">::</span><span class="fu">writePNG</span>(<span class="st">"_flowchart_lca0_adj_sin_po.png"</span>)</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>htmlwidgets<span class="sc">::</span><span class="fu">saveWidget</span>(gr_lca2, <span class="st">"_flowchart_lca_adj_sin_po_ano.html"</span>)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="co">#webshot::webshot("_flowchart_lca_adj_ano.html", "_flowchart_lca_adj_sin_po_ano.png",vwidth = 1200, vheight = 900, zoom = 2)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="análisis-de-clases-latentes-modelos-definitivos-sin-pueblo-originario-y-año" class="level1">
<h1>Análisis de clases latentes, modelos definitivos, sin pueblo originario y año</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>());<span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          used  (Mb) gc trigger   (Mb)  max used   (Mb)
Ncells 3565386 190.5    6004207  320.7   6004207  320.7
Vcells 6223999  47.5  295552823 2254.9 325281282 2481.7</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"data2_lca3_sin_po_ano_2023_05_14.RData"</span>) <span class="co">#Paso 213 y 214</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#variables_probabilities_in_category_sin_po_ano.xlsx</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#variables_probabilities_in_category_glca_adj_sin_po.xlsxbootlrt</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(sjPlot)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(tidyverse)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(tableone)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>manualcolors<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">"gray"</span>,<span class="fu">seq</span>(<span class="dv">20</span>,<span class="dv">80</span>, <span class="at">by=</span><span class="dv">20</span>)))</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>fig_lca_fit<span class="ot">&lt;-</span> tab_ppio <span class="sc">%&gt;%</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_if</span>(is.character, as.numeric) <span class="sc">%&gt;%</span>  <span class="co"># convert character columns to numeric</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>ModelIndex, <span class="co">#"evryone but index"</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">names_to =</span> <span class="st">"indices"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>, <span class="at">values_drop_na =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">indices =</span> <span class="fu">factor</span>(indices, <span class="at">levels =</span> levels, <span class="at">labels =</span> labels)) <span class="sc">%&gt;%</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"(BIC)"</span>,indices, <span class="at">ignore.case=</span>T))<span class="sc">%&gt;%</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">ModelIndex=</span> <span class="fu">factor</span>(ModelIndex, <span class="at">levels=</span><span class="dv">2</span><span class="sc">:</span>n_class_max)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ModelIndex, <span class="at">y =</span> value, <span class="at">group =</span> indices, <span class="at">color =</span> indices, <span class="at">linetype =</span> indices)) <span class="sc">+</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> manualcolors) <span class="sc">+</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_linetype_manual(values = c("solid", "dashed", "dotted")) +</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Número de clases"</span>, <span class="at">y=</span><span class="st">"Valor"</span>, <span class="at">color=</span><span class="st">"Medida"</span>, <span class="at">linetype=</span><span class="st">"Medida"</span>)<span class="sc">+</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#facet_wrap(.~indices, scales = "free_y", nrow = 4, ncol = 1) +</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  sjPlot<span class="sc">::</span><span class="fu">theme_sjplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>fig_lca_fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Paso4_files/figure-html/corregir-fig-ajuste-1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Índices de ajuste, modelo sin covariable</figcaption>
</figure>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"__fig2_medidas_de_ajuste_polca_sin_ano_pueb_orig.pdf"</span>,fig_lca_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>manualcolors2<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">"gray"</span>,<span class="fu">seq</span>(<span class="dv">20</span>,<span class="dv">80</span>, <span class="at">by=</span><span class="dv">20</span>)))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>fig_lca_fit2<span class="ot">&lt;-</span> tab_ppio2 <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_if</span>(is.character, as.numeric) <span class="sc">%&gt;%</span>  <span class="co"># convert character columns to numeric</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>ModelIndex, <span class="co">#"evryone but index"</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">names_to =</span> <span class="st">"indices"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>, <span class="at">values_drop_na =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">indices =</span> <span class="fu">factor</span>(indices, <span class="at">levels =</span> levels2, <span class="at">labels =</span> labels2)) <span class="sc">%&gt;%</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"BIC"</span>,indices, <span class="at">ignore.case=</span>T))<span class="sc">%&gt;%</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">ModelIndex=</span> <span class="fu">factor</span>(ModelIndex, <span class="at">levels=</span><span class="dv">2</span><span class="sc">:</span>n_class_max)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ModelIndex, <span class="at">y =</span> value, <span class="at">group =</span> indices, <span class="at">color =</span> indices, <span class="at">linetype =</span> indices)) <span class="sc">+</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> manualcolors2) <span class="sc">+</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_linetype_manual(values = c("solid", "dashed", "dotted")) +</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Número de clases"</span>, <span class="at">y=</span><span class="st">"Valor"</span>, <span class="at">color=</span><span class="st">"Medida"</span>,<span class="at">linetype=</span><span class="st">"Medida"</span>)<span class="sc">+</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#facet_wrap(.~indices, scales = "free_y", nrow = 4, ncol = 1) +</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  sjPlot<span class="sc">::</span><span class="fu">theme_sjplot</span>()</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>fig_lca_fit2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Paso4_files/figure-html/corregir-fig-ajuste-2-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Índices de ajuste, modelo variable distal</figcaption>
</figure>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"__fig3_medidas_de_ajuste_polca_sin_ano_pueb_orig_adj.pdf"</span>,fig_lca_fit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
</div>
<div class="controlly">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>table_homolog<span class="ot">&lt;-</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="at">Name =</span> <span class="fu">c</span>(<span class="st">"n"</span>, <span class="st">"CAUSAL"</span>, <span class="st">"CAUSAL"</span>, <span class="st">"CAUSAL"</span>, <span class="st">"EDAD_MUJER_REC"</span>, </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"EDAD_MUJER_REC"</span>, <span class="st">"EDAD_MUJER_REC"</span>, <span class="st">"EDAD_MUJER_REC"</span>, <span class="st">"EDAD_MUJER_REC"</span>, </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"PAIS_ORIGEN_REC"</span>, <span class="st">"PAIS_ORIGEN_REC"</span>, <span class="st">"PAIS_ORIGEN_REC"</span>, <span class="st">"HITO1_EDAD_GEST_SEM_REC"</span>, </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"HITO1_EDAD_GEST_SEM_REC"</span>, <span class="st">"HITO1_EDAD_GEST_SEM_REC"</span>, <span class="st">"HITO1_EDAD_GEST_SEM_REC"</span>, </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"MACROZONA"</span>, <span class="st">"MACROZONA"</span>, <span class="st">"MACROZONA"</span>, <span class="st">"MACROZONA"</span>, <span class="st">"MACROZONA"</span>, </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"MACROZONA"</span>, <span class="st">"AÑO"</span>, <span class="st">"AÑO"</span>, <span class="st">"AÑO"</span>, <span class="st">"AÑO"</span>, <span class="st">"AÑO"</span>, <span class="st">"PREV_TRAMO_REC"</span>, </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"PREV_TRAMO_REC"</span>, <span class="st">"PREV_TRAMO_REC"</span>, <span class="st">"PREV_TRAMO_REC"</span>, <span class="st">"PREV_TRAMO_REC"</span>, </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"HITO2_DECISION_MUJER_IVE"</span>, <span class="st">"HITO2_DECISION_MUJER_IVE"</span>, <span class="st">"HITO2_DECISION_MUJER_IVE"</span>,<span class="st">"HITO4_MUJER_ACEPTA_ACOM"</span>,<span class="st">"HITO4_MUJER_ACEPTA_ACOM"</span>,<span class="st">"HITO4_MUJER_ACEPTA_ACOM"</span>),</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="at">level =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"5"</span>, <span class="st">"1"</span>, </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>          <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"5"</span>, <span class="st">"6"</span>, <span class="st">"2"</span>, </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>          <span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"5"</span>, <span class="st">"6"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>, <span class="st">"5"</span>, <span class="st">"CONTINUAR EL EMBARAZO"</span>, </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>          <span class="st">"INTERRUMPIR EL EMBARAZO"</span>, <span class="st">"NO APLICA, INSCONSCIENTE"</span>,<span class="st">"NO"</span>, <span class="st">"SI"</span>, <span class="st">"NA"</span>),</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="at">cat =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"Causal 1"</span>, <span class="st">"Causal 2"</span>, <span class="st">"Causal 3"</span>, <span class="st">"[Perdidos]"</span>, <span class="st">"1. &lt;18"</span>, <span class="st">"2. 18-24"</span>, <span class="st">"3. 25-35"</span>, <span class="st">"4. &gt;=35"</span>, </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>          <span class="st">"[Perdidos]"</span>, <span class="st">"Chile"</span>, <span class="st">"Otros"</span>, <span class="st">"[Perdidos]"</span>, <span class="st">"1. 0-13 semanas"</span>, <span class="st">"2. 14-27 semanas"</span>, <span class="st">"3. &gt;=28 semanas"</span>, </span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>          <span class="st">"[Perdidos]"</span>, <span class="st">"Centro"</span>, <span class="st">"Centro Norte"</span>, <span class="st">"Centro Sur"</span>, <span class="st">"Norte"</span>, <span class="st">"Sur"</span>, <span class="st">"2018"</span>, <span class="st">"2019"</span>, <span class="st">"2020"</span>, <span class="st">"2021"</span>, <span class="st">"2022"</span>, </span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>          <span class="st">"[Perdidos]"</span>, <span class="st">"ISAPRE o FFAA"</span>, <span class="st">"FONASA A/B"</span>, <span class="st">"FONASA C/D"</span>, <span class="st">"NINGUNA"</span>, <span class="st">"CONTINUAR EL EMBARAZO"</span>, <span class="st">"INTERRUMPIR EL EMBARAZO"</span>, <span class="st">"NO APLICA, INSCONSCIENTE"</span>, <span class="st">"NO"</span>, <span class="st">"SI"</span>, <span class="st">"[Perdidos]"</span>)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="fu">run_tableone</span>(<span class="at">listVars =</span><span class="fu">c</span>(<span class="st">"CAUSAL"</span>, <span class="st">"EDAD_MUJER_REC"</span>, <span class="st">"PAIS_ORIGEN_REC"</span>, </span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"HITO1_EDAD_GEST_SEM_REC"</span>,<span class="st">"MACROZONA"</span>, <span class="st">"AÑO"</span>, <span class="st">"PREV_TRAMO_REC"</span>,</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"HITO2_DECISION_MUJER_IVE"</span>,<span class="st">"HITO4_MUJER_ACEPTA_ACOM"</span>), <span class="at">df=</span> <span class="fu">cbind.data.frame</span>(mydata_preds3,<span class="at">HITO4_MUJER_ACEPTA_ACOM=</span>mydata_preds<span class="sc">$</span>HITO4_MUJER_ACEPTA_ACOM), </span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">catVars=</span> <span class="fu">c</span>(<span class="st">"CAUSAL"</span>, <span class="st">"EDAD_MUJER_REC"</span>, <span class="st">"PAIS_ORIGEN_REC"</span>, </span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"HITO1_EDAD_GEST_SEM_REC"</span>,<span class="st">"MACROZONA"</span>, <span class="st">"AÑO"</span>, <span class="st">"PREV_TRAMO_REC"</span>, <span class="st">"HITO4_MUJER_ACEPTA_ACOM"</span>),</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>             <span class="at">strata=</span> <span class="st">"outcome"</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(table_homolog, <span class="at">by=</span> <span class="fu">c</span>(<span class="st">"Name"</span><span class="ot">=</span><span class="st">"Name"</span>,<span class="st">"level"</span><span class="ot">=</span><span class="st">"level"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Name, cat, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>level) <span class="sc">%&gt;%</span> </span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="st">"markdown"</span>, <span class="at">caption=</span><span class="st">"Descriptivos (acotado)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `add_rownames()` was deprecated in dplyr 1.0.0.
ℹ Please use `tibble::rownames_to_column()` instead.</code></pre>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Descriptivos (acotado)</caption>
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 12%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 7%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Name</th>
<th style="text-align: left;">cat</th>
<th style="text-align: left;">Overall</th>
<th style="text-align: left;">0</th>
<th style="text-align: left;">1</th>
<th style="text-align: left;">p</th>
<th style="text-align: left;">test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">n</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">3789</td>
<td style="text-align: left;">606</td>
<td style="text-align: left;">3183</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">CAUSAL</td>
<td style="text-align: left;">Causal 1</td>
<td style="text-align: left;">1171 (30.9)</td>
<td style="text-align: left;">203 (33.5)</td>
<td style="text-align: left;">968 ( 30.4)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">CAUSAL</td>
<td style="text-align: left;">Causal 2</td>
<td style="text-align: left;">1887 (49.8)</td>
<td style="text-align: left;">346 (57.1)</td>
<td style="text-align: left;">1541 ( 48.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">CAUSAL</td>
<td style="text-align: left;">Causal 3</td>
<td style="text-align: left;">731 (19.3)</td>
<td style="text-align: left;">57 ( 9.4)</td>
<td style="text-align: left;">674 ( 21.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">EDAD_MUJER_REC</td>
<td style="text-align: left;">[Perdidos]</td>
<td style="text-align: left;">18 ( 0.5)</td>
<td style="text-align: left;">2 ( 0.3)</td>
<td style="text-align: left;">16 ( 0.5)</td>
<td style="text-align: left;">0.024</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">EDAD_MUJER_REC</td>
<td style="text-align: left;">1. &lt;18</td>
<td style="text-align: left;">269 ( 7.1)</td>
<td style="text-align: left;">55 ( 9.1)</td>
<td style="text-align: left;">214 ( 6.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">EDAD_MUJER_REC</td>
<td style="text-align: left;">2. 18-24</td>
<td style="text-align: left;">720 (19.0)</td>
<td style="text-align: left;">102 (16.8)</td>
<td style="text-align: left;">618 ( 19.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">EDAD_MUJER_REC</td>
<td style="text-align: left;">3. 25-35</td>
<td style="text-align: left;">1646 (43.4)</td>
<td style="text-align: left;">243 (40.1)</td>
<td style="text-align: left;">1403 ( 44.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">EDAD_MUJER_REC</td>
<td style="text-align: left;">4. &gt;=35</td>
<td style="text-align: left;">1136 (30.0)</td>
<td style="text-align: left;">204 (33.7)</td>
<td style="text-align: left;">932 ( 29.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">PAIS_ORIGEN_REC</td>
<td style="text-align: left;">[Perdidos]</td>
<td style="text-align: left;">18 ( 0.5)</td>
<td style="text-align: left;">5 ( 0.8)</td>
<td style="text-align: left;">13 ( 0.4)</td>
<td style="text-align: left;">0.005</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">PAIS_ORIGEN_REC</td>
<td style="text-align: left;">Chile</td>
<td style="text-align: left;">3091 (81.6)</td>
<td style="text-align: left;">518 (85.5)</td>
<td style="text-align: left;">2573 ( 80.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">PAIS_ORIGEN_REC</td>
<td style="text-align: left;">Otros</td>
<td style="text-align: left;">680 (17.9)</td>
<td style="text-align: left;">83 (13.7)</td>
<td style="text-align: left;">597 ( 18.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">HITO1_EDAD_GEST_SEM_REC</td>
<td style="text-align: left;">[Perdidos]</td>
<td style="text-align: left;">87 ( 2.3)</td>
<td style="text-align: left;">12 ( 2.0)</td>
<td style="text-align: left;">75 ( 2.4)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">HITO1_EDAD_GEST_SEM_REC</td>
<td style="text-align: left;">1. 0-13 semanas</td>
<td style="text-align: left;">1328 (35.0)</td>
<td style="text-align: left;">128 (21.1)</td>
<td style="text-align: left;">1200 ( 37.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">HITO1_EDAD_GEST_SEM_REC</td>
<td style="text-align: left;">2. 14-27 semanas</td>
<td style="text-align: left;">2008 (53.0)</td>
<td style="text-align: left;">343 (56.6)</td>
<td style="text-align: left;">1665 ( 52.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">HITO1_EDAD_GEST_SEM_REC</td>
<td style="text-align: left;">3. &gt;=28 semanas</td>
<td style="text-align: left;">366 ( 9.7)</td>
<td style="text-align: left;">123 (20.3)</td>
<td style="text-align: left;">243 ( 7.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">MACROZONA</td>
<td style="text-align: left;">[Perdidos]</td>
<td style="text-align: left;">11 ( 0.3)</td>
<td style="text-align: left;">3 ( 0.5)</td>
<td style="text-align: left;">8 ( 0.3)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">MACROZONA</td>
<td style="text-align: left;">Centro</td>
<td style="text-align: left;">1608 (42.4)</td>
<td style="text-align: left;">198 (32.7)</td>
<td style="text-align: left;">1410 ( 44.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">MACROZONA</td>
<td style="text-align: left;">Centro Norte</td>
<td style="text-align: left;">610 (16.1)</td>
<td style="text-align: left;">74 (12.2)</td>
<td style="text-align: left;">536 ( 16.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">MACROZONA</td>
<td style="text-align: left;">Centro Sur</td>
<td style="text-align: left;">555 (14.6)</td>
<td style="text-align: left;">154 (25.4)</td>
<td style="text-align: left;">401 ( 12.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">MACROZONA</td>
<td style="text-align: left;">Norte</td>
<td style="text-align: left;">431 (11.4)</td>
<td style="text-align: left;">70 (11.6)</td>
<td style="text-align: left;">361 ( 11.3)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">MACROZONA</td>
<td style="text-align: left;">Sur</td>
<td style="text-align: left;">574 (15.1)</td>
<td style="text-align: left;">107 (17.7)</td>
<td style="text-align: left;">467 ( 14.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">AÑO</td>
<td style="text-align: left;">2018</td>
<td style="text-align: left;">732 (19.3)</td>
<td style="text-align: left;">115 (19.0)</td>
<td style="text-align: left;">617 ( 19.4)</td>
<td style="text-align: left;">0.306</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">AÑO</td>
<td style="text-align: left;">2019</td>
<td style="text-align: left;">818 (21.6)</td>
<td style="text-align: left;">149 (24.6)</td>
<td style="text-align: left;">669 ( 21.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">AÑO</td>
<td style="text-align: left;">2020</td>
<td style="text-align: left;">662 (17.5)</td>
<td style="text-align: left;">103 (17.0)</td>
<td style="text-align: left;">559 ( 17.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">AÑO</td>
<td style="text-align: left;">2021</td>
<td style="text-align: left;">820 (21.6)</td>
<td style="text-align: left;">131 (21.6)</td>
<td style="text-align: left;">689 ( 21.6)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">AÑO</td>
<td style="text-align: left;">2022</td>
<td style="text-align: left;">757 (20.0)</td>
<td style="text-align: left;">108 (17.8)</td>
<td style="text-align: left;">649 ( 20.4)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">PREV_TRAMO_REC</td>
<td style="text-align: left;">[Perdidos]</td>
<td style="text-align: left;">14 ( 0.4)</td>
<td style="text-align: left;">4 ( 0.7)</td>
<td style="text-align: left;">10 ( 0.3)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">PREV_TRAMO_REC</td>
<td style="text-align: left;">ISAPRE o FFAA</td>
<td style="text-align: left;">488 (12.9)</td>
<td style="text-align: left;">37 ( 6.1)</td>
<td style="text-align: left;">451 ( 14.2)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">PREV_TRAMO_REC</td>
<td style="text-align: left;">FONASA A/B</td>
<td style="text-align: left;">2096 (55.3)</td>
<td style="text-align: left;">382 (63.0)</td>
<td style="text-align: left;">1714 ( 53.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">PREV_TRAMO_REC</td>
<td style="text-align: left;">FONASA C/D</td>
<td style="text-align: left;">1092 (28.8)</td>
<td style="text-align: left;">179 (29.5)</td>
<td style="text-align: left;">913 ( 28.7)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">PREV_TRAMO_REC</td>
<td style="text-align: left;">NINGUNA</td>
<td style="text-align: left;">99 ( 2.6)</td>
<td style="text-align: left;">4 ( 0.7)</td>
<td style="text-align: left;">95 ( 3.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">HITO2_DECISION_MUJER_IVE</td>
<td style="text-align: left;">CONTINUAR EL EMBARAZO</td>
<td style="text-align: left;">593 (15.7)</td>
<td style="text-align: left;">593 (97.9)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">&lt;0.001</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">HITO2_DECISION_MUJER_IVE</td>
<td style="text-align: left;">INTERRUMPIR EL EMBARAZO</td>
<td style="text-align: left;">3183 (84.0)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;">3183 (100.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">HITO2_DECISION_MUJER_IVE</td>
<td style="text-align: left;">NO APLICA, INSCONSCIENTE</td>
<td style="text-align: left;">13 ( 0.3)</td>
<td style="text-align: left;">13 ( 2.1)</td>
<td style="text-align: left;">0 ( 0.0)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">HITO4_MUJER_ACEPTA_ACOM</td>
<td style="text-align: left;">NO</td>
<td style="text-align: left;">463 (12.2)</td>
<td style="text-align: left;">93 (15.3)</td>
<td style="text-align: left;">370 ( 11.6)</td>
<td style="text-align: left;">0.017</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">HITO4_MUJER_ACEPTA_ACOM</td>
<td style="text-align: left;">SI</td>
<td style="text-align: left;">3225 (85.1)</td>
<td style="text-align: left;">502 (82.8)</td>
<td style="text-align: left;">2723 ( 85.5)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">HITO4_MUJER_ACEPTA_ACOM</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">101 ( 2.7)</td>
<td style="text-align: left;">11 ( 1.8)</td>
<td style="text-align: left;">90 ( 2.8)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>  <span class="co">#knitr::kable("html", caption="Descriptivos (acotado)") %&gt;% kableExtra::kable_classic()</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>no_mostrar<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">#if(no_mostrar==0){</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#    dplyr::select(HITO2_DECISION_MUJER_IVE, c("CAUSAL", "EDAD_MUJER_REC", "PAIS_ORIGEN_REC", "HITO1_EDAD_GEST_SEM_REC","MACROZONA", "AÑO", "PREV_TRAMO_REC")) %&gt;% </span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  chisquare_test<span class="ot">&lt;-</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  mydata_preds3<span class="sc">%&gt;%</span> </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>( </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">"CAUSAL"</span>, <span class="st">"EDAD_MUJER_REC"</span>, <span class="st">"PAIS_ORIGEN_REC"</span>, </span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"HITO1_EDAD_GEST_SEM_REC"</span>,<span class="st">"MACROZONA"</span>, <span class="st">"PREV_TRAMO_REC"</span>, <span class="st">"outcome"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">gather</span>(variable,measure, <span class="sc">-</span>outcome) <span class="sc">%&gt;%</span> </span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">do</span>(<span class="fu">cbind.data.frame</span>(broom<span class="sc">::</span><span class="fu">tidy</span>(<span class="fu">chisq.test</span>(.<span class="sc">$</span>outcome, .<span class="sc">$</span>measure)),</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>                               broom<span class="sc">::</span><span class="fu">tidy</span>(<span class="fu">sum</span>(<span class="fu">table</span>(.<span class="sc">$</span>outcome, .<span class="sc">$</span>measure))))) <span class="sc">%&gt;%</span> </span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">#casos completos</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">#chisq.test(table(Base_fiscalia_v14_filt$motivodeegreso_mod_imp_rec, Base_fiscalia_v14_filt$sus_principal_mod, exclude=NULL))</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">p.value=</span><span class="fu">ifelse</span>(p.value<span class="sc">&lt;</span>.<span class="dv">001</span>,<span class="st">"&lt;0.001"</span>,<span class="fu">sprintf</span>(<span class="st">"%1.3f"</span>,p.value))) <span class="sc">%&gt;%</span> </span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">statistic=</span><span class="fu">sprintf</span>(<span class="st">"%2.0f"</span>,statistic)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">report=</span><span class="fu">paste0</span>(<span class="st">"X²("</span>,parameter,<span class="st">", "</span>,x,<span class="st">")="</span>,statistic,<span class="st">"; p"</span>, <span class="fu">ifelse</span>(p.value<span class="sc">==</span><span class="st">"&lt;0.001"</span>,p.value, <span class="fu">paste0</span>(<span class="st">"="</span>,p.value)))) <span class="sc">%&gt;%</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">report=</span><span class="fu">sub</span>(<span class="st">"0</span><span class="sc">\\</span><span class="st">."</span>,<span class="st">"0,"</span>,<span class="fu">sub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">."</span>,<span class="st">","</span>,report)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'tidy.numeric' is deprecated.
See help("Deprecated")</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in chisq.test(.$outcome, .$measure): Chi-squared approximation may be
incorrect</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'tidy.numeric' is deprecated.
See help("Deprecated")

Warning: 'tidy.numeric' is deprecated.
See help("Deprecated")</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in chisq.test(.$outcome, .$measure): Chi-squared approximation may be
incorrect</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'tidy.numeric' is deprecated.
See help("Deprecated")</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in chisq.test(.$outcome, .$measure): Chi-squared approximation may be
incorrect</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'tidy.numeric' is deprecated.
See help("Deprecated")</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in chisq.test(.$outcome, .$measure): Chi-squared approximation may be
incorrect</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 'tidy.numeric' is deprecated.
See help("Deprecated")</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># chisq.test(Base_fiscalia_v14_filt$motivodeegreso_mod_imp_rec, is.na(Base_fiscalia_v14_filt$offender_d)) </span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># chisq.test(Base_fiscalia_v14_filt$motivodeegreso_mod_imp_rec, is.na(Base_fiscalia_v14_filt$offender_d)) </span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  fisher_test<span class="ot">&lt;-</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  mydata_preds3 <span class="sc">%&gt;%</span> </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>( </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"CAUSAL"</span>, <span class="st">"EDAD_MUJER_REC"</span>, <span class="st">"PREV_TRAMO_REC"</span>, <span class="st">"MACROZONA"</span>, <span class="st">"outcome"</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">gather</span>(variable,measure, <span class="sc">-</span>outcome) <span class="sc">%&gt;%</span> </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">do</span>(<span class="fu">fisher.test</span>(<span class="fu">table</span>(.<span class="sc">$</span>outcome, .<span class="sc">$</span>measure, <span class="at">exclude=</span><span class="cn">NULL</span>), </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">workspace =</span> <span class="fl">2e10</span>, <span class="at">simulate.p.value =</span> T, <span class="at">B=</span><span class="fl">1e5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>                broom<span class="sc">::</span><span class="fu">tidy</span>()) </span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#EDAD_MUJER  HITO1_EDAD_GESTACIONAL_SEMANAS  </span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  med_iqr <span class="ot">&lt;-</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind.data.frame</span>(<span class="at">medicion=</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Edad persona gestante: "</span>,</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quantile</span>(data2<span class="sc">$</span>EDAD_MUJER,.<span class="dv">5</span>, <span class="at">na.rm=</span>T), <span class="st">"["</span>,</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quantile</span>(data2<span class="sc">$</span>EDAD_MUJER,.<span class="dv">25</span>, <span class="at">na.rm=</span>T),<span class="st">", "</span>,</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quantile</span>(data2<span class="sc">$</span>EDAD_MUJER,.<span class="dv">75</span>, <span class="at">na.rm=</span>T),<span class="st">"]"</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  ), <span class="at">medicion=</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Edad persona gestante (IVE): "</span>,</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quantile</span>(data2<span class="sc">$</span>EDAD_MUJER[mydata_preds3<span class="sc">$</span>outcome<span class="sc">==</span><span class="dv">1</span>],.<span class="dv">5</span>, <span class="at">na.rm=</span>T), <span class="st">"["</span>,</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quantile</span>(data2<span class="sc">$</span>EDAD_MUJER[mydata_preds3<span class="sc">$</span>outcome<span class="sc">==</span><span class="dv">1</span>],.<span class="dv">25</span>, <span class="at">na.rm=</span>T),<span class="st">", "</span>,</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quantile</span>(data2<span class="sc">$</span>EDAD_MUJER[mydata_preds3<span class="sc">$</span>outcome<span class="sc">==</span><span class="dv">1</span>],.<span class="dv">75</span>, <span class="at">na.rm=</span>T),<span class="st">"]"</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="at">medicion=</span><span class="fu">paste0</span>(</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Edad persona gestante (no IVE): "</span>,</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quantile</span>(data2<span class="sc">$</span>EDAD_MUJER[mydata_preds3<span class="sc">$</span>outcome<span class="sc">==</span><span class="dv">0</span>],.<span class="dv">5</span>, <span class="at">na.rm=</span>T), <span class="st">"["</span>,</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quantile</span>(data2<span class="sc">$</span>EDAD_MUJER[mydata_preds3<span class="sc">$</span>outcome<span class="sc">==</span><span class="dv">0</span>],.<span class="dv">25</span>, <span class="at">na.rm=</span>T),<span class="st">", "</span>,</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quantile</span>(data2<span class="sc">$</span>EDAD_MUJER[mydata_preds3<span class="sc">$</span>outcome<span class="sc">==</span><span class="dv">0</span>],.<span class="dv">75</span>, <span class="at">na.rm=</span>T),<span class="st">"]"</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a><span class="at">medicion=</span><span class="fu">paste0</span>(</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Edad gestacional en semanas: "</span>,</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quantile</span>(data2<span class="sc">$</span>HITO1_EDAD_GESTACIONAL_SEMANAS,.<span class="dv">5</span>, <span class="at">na.rm=</span>T), <span class="st">"["</span>, <span class="fu">quantile</span>(data2<span class="sc">$</span>HITO1_EDAD_GESTACIONAL_SEMANAS,.<span class="dv">25</span>, <span class="at">na.rm=</span>T),<span class="st">", "</span>, <span class="fu">quantile</span>(data2<span class="sc">$</span>HITO1_EDAD_GESTACIONAL_SEMANAS,.<span class="dv">75</span>, <span class="at">na.rm=</span>T),<span class="st">"]"</span>),</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a><span class="at">medicion=</span><span class="fu">paste0</span>(</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Edad gestacional en semanas (IVE): "</span>,</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quantile</span>(data2<span class="sc">$</span>HITO1_EDAD_GESTACIONAL_SEMANAS[mydata_preds3<span class="sc">$</span>outcome<span class="sc">==</span><span class="dv">1</span>],.<span class="dv">5</span>, <span class="at">na.rm=</span>T), <span class="st">"["</span>, <span class="fu">quantile</span>(data2<span class="sc">$</span>HITO1_EDAD_GESTACIONAL_SEMANAS[mydata_preds3<span class="sc">$</span>outcome<span class="sc">==</span><span class="dv">1</span>],.<span class="dv">25</span>, <span class="at">na.rm=</span>T),<span class="st">", "</span>, <span class="fu">quantile</span>(data2<span class="sc">$</span>HITO1_EDAD_GESTACIONAL_SEMANAS[mydata_preds3<span class="sc">$</span>outcome<span class="sc">==</span><span class="dv">1</span>],.<span class="dv">75</span>, <span class="at">na.rm=</span>T),<span class="st">"]"</span>),</span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a><span class="at">medicion=</span><span class="fu">paste0</span>(</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Edad gestacional en semanas (no IVE): "</span>,</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quantile</span>(data2<span class="sc">$</span>HITO1_EDAD_GESTACIONAL_SEMANAS[mydata_preds3<span class="sc">$</span>outcome<span class="sc">==</span><span class="dv">0</span>],.<span class="dv">5</span>, <span class="at">na.rm=</span>T), <span class="st">"["</span>, <span class="fu">quantile</span>(data2<span class="sc">$</span>HITO1_EDAD_GESTACIONAL_SEMANAS[mydata_preds3<span class="sc">$</span>outcome<span class="sc">==</span><span class="dv">0</span>],.<span class="dv">25</span>, <span class="at">na.rm=</span>T),<span class="st">", "</span>, <span class="fu">quantile</span>(data2<span class="sc">$</span>HITO1_EDAD_GESTACIONAL_SEMANAS[mydata_preds3<span class="sc">$</span>outcome<span class="sc">==</span><span class="dv">0</span>],.<span class="dv">75</span>, <span class="at">na.rm=</span>T),<span class="st">"]"</span> )</span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(med_iqr)<span class="ot">&lt;-</span><span class="st">"medicion"</span></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Kurksal Wallis</span></span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>  kruskal<span class="ot">&lt;-</span></span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind.data.frame</span>(</span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">name=</span><span class="fu">paste0</span>(<span class="st">"Edad persona gestante (continua): H("</span>,<span class="fu">kruskal.test</span>(data2<span class="sc">$</span>EDAD_MUJER <span class="sc">~</span> mydata_preds3<span class="sc">$</span>outcome)<span class="sc">$</span>parameter,<span class="st">")="</span>,</span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>         <span class="fu">round</span>(<span class="fu">kruskal.test</span>(data2<span class="sc">$</span>EDAD_MUJER <span class="sc">~</span> mydata_preds3<span class="sc">$</span>outcome)<span class="sc">$</span>statistic,<span class="dv">1</span>), <span class="st">", p="</span>,</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>         <span class="fu">round</span>(<span class="fu">kruskal.test</span>(data2<span class="sc">$</span>EDAD_MUJER <span class="sc">~</span> mydata_preds3<span class="sc">$</span>outcome)<span class="sc">$</span>p.value,<span class="dv">3</span>)),</span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">name=</span><span class="fu">paste0</span>(<span class="st">"Edad gestacional (continua): H("</span>,<span class="fu">kruskal.test</span>(data2<span class="sc">$</span>HITO1_EDAD_GESTACIONAL_SEMANAS <span class="sc">~</span> mydata_preds3<span class="sc">$</span>outcome)<span class="sc">$</span>parameter,<span class="st">")="</span>,</span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>         <span class="fu">round</span>(<span class="fu">kruskal.test</span>(data2<span class="sc">$</span>HITO1_EDAD_GESTACIONAL_SEMANAS <span class="sc">~</span> mydata_preds3<span class="sc">$</span>outcome)<span class="sc">$</span>statistic,<span class="dv">1</span>), <span class="st">", p="</span>,</span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>         <span class="fu">round</span>(<span class="fu">kruskal.test</span>(data2<span class="sc">$</span>HITO1_EDAD_GESTACIONAL_SEMANAS <span class="sc">~</span> mydata_preds3<span class="sc">$</span>outcome)<span class="sc">$</span>p.value,<span class="dv">3</span>))</span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(kruskal)<span class="ot">&lt;-</span><span class="st">"names"</span></span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a>  rio<span class="sc">::</span><span class="fu">export</span>(<span class="fu">list</span>(<span class="at">chisquare_test =</span> chisquare_test, </span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fisher_test =</span> fisher_test, </span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a>                   <span class="at">kruskal=</span> kruskal,</span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a>                   <span class="at">iqr=</span> med_iqr), <span class="st">"tableone_extension.xlsx"</span>, <span class="at">overwrite =</span> T)</span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a><span class="co">#, error= T}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<section id="figuras-polca" class="level2">
<h2 class="anchored" data-anchor-id="figuras-polca">Figuras (poLCA)</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#https://agscl.github.io/IVE/Paso35.html</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(plotly)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co">#https://github.com/slowkow/ggrepel</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>lcmodel_wo_na<span class="ot">&lt;-</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>lcmodel <span class="sc">%&gt;%</span> </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>                 dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(CATEGORIA)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>                 dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Var1=</span><span class="fu">str_replace</span>(Var1,<span class="st">"class"</span>,<span class="st">"Clase"</span>),</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">L2=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(L2<span class="sc">==</span><span class="st">"CAUSAL"</span><span class="sc">~</span> <span class="st">"Causal"</span>,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>                                      L2<span class="sc">==</span><span class="st">"EDAD_MUJER_REC"</span><span class="sc">~</span> <span class="st">"Edad persona</span><span class="sc">\n</span><span class="st">gestante"</span>,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>                                      L2<span class="sc">==</span><span class="st">"MACROZONA"</span><span class="sc">~</span> <span class="st">"Macrozona"</span>,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>                                      L2<span class="sc">==</span><span class="st">"HITO1_EDAD_GEST_SEM_REC"</span><span class="sc">~</span> <span class="st">"Edad Gestacional</span><span class="sc">\n</span><span class="st">(EG) Hito 1"</span>,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>                                      L2<span class="sc">==</span><span class="st">"PREV_TRAMO_REC"</span><span class="sc">~</span> <span class="st">"Previsión y</span><span class="sc">\n</span><span class="st">tramo"</span>,</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>                                    L2<span class="sc">==</span><span class="st">"PAIS_ORIGEN_REC"</span><span class="sc">~</span> <span class="st">"País de origen"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">CATEGORIA=</span> <span class="fu">gsub</span>(<span class="st">"1.0-13 semanas"</span>,<span class="st">"1. &lt;=13 semanas"</span>,CATEGORIA)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">CATEGORIA=</span> <span class="fu">gsub</span>(<span class="st">"CENTRO"</span>,<span class="st">"Centro"</span>,CATEGORIA)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">CATEGORIA=</span> <span class="fu">gsub</span>(<span class="st">"CENTRO NORTE"</span>,<span class="st">"Centro norte"</span>,CATEGORIA)) <span class="sc">%&gt;%</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">CATEGORIA=</span> <span class="fu">gsub</span>(<span class="st">"CENTRO SUR"</span>,<span class="st">"Centro sur"</span>,CATEGORIA)) <span class="sc">%&gt;%</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">CATEGORIA=</span> <span class="fu">gsub</span>(<span class="st">"NORTE"</span>,<span class="st">"Norte"</span>,CATEGORIA)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">CATEGORIA=</span> <span class="fu">gsub</span>(<span class="st">"SUR"</span>,<span class="st">"Sur"</span>,CATEGORIA)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">CATEGORIA=</span> <span class="fu">gsub</span>(<span class="st">"25-35"</span>,<span class="st">"25-34"</span>,CATEGORIA)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">CATEGORIA=</span> <span class="fu">gsub</span>(<span class="st">"25-35"</span>,<span class="st">"25-34"</span>,CATEGORIA)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">CATEGORIA=</span> <span class="fu">gsub</span>(<span class="st">"25-35"</span>,<span class="st">"25-34"</span>,CATEGORIA)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">CATEGORIA=</span> <span class="fu">gsub</span>(<span class="st">"25-35"</span>,<span class="st">"25-34"</span>,CATEGORIA)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">CATEGORIA=</span> <span class="fu">gsub</span>(<span class="st">"25-35"</span>,<span class="st">"25-34"</span>,CATEGORIA)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lab2=</span>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{stringr::str_replace(CATEGORIA,' ','</span><span class="sc">\n</span><span class="st">')}</span><span class="sc">\n</span><span class="st">({scales::percent(value)})"</span>))</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a><span class="co">#2023-09-24</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>lcmodel_wo_na<span class="sc">$</span>text_label_pre<span class="ot">&lt;-</span><span class="fu">paste0</span>(<span class="st">"Categoria:"</span>,lcmodel_wo_na<span class="sc">$</span>CATEGORIA,<span class="st">"&lt;br&gt;%: "</span>,scales<span class="sc">::</span><span class="fu">percent</span>(lcmodel_wo_na<span class="sc">$</span>value))</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>zp1a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(lcmodel_wo_na,<span class="fu">aes</span>(<span class="at">x =</span> L2, <span class="at">y =</span> value, <span class="at">fill =</span> Var2, <span class="at">label=</span>text_label_pre))</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>zp1a <span class="ot">&lt;-</span> zp1a <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"stack"</span>)</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>zp1a <span class="ot">&lt;-</span> zp1a <span class="sc">+</span> <span class="fu">facet_grid</span>(Var1 <span class="sc">~</span> .) </span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>zp1a <span class="ot">&lt;-</span> zp1a <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">type=</span><span class="st">"seq"</span>, <span class="at">palette=</span><span class="st">"Greys"</span>, <span class="at">na.value =</span> <span class="st">"white"</span>) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>zp1a <span class="ot">&lt;-</span> zp1a <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Porcentaje de probabilidad de respuesta"</span>, </span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span><span class="st">"Cateorías de</span><span class="sc">\n</span><span class="st">Respuesta"</span>)</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>zp1a <span class="ot">&lt;-</span> zp1a <span class="sc">+</span> <span class="fu">theme</span>( <span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>                    <span class="at">axis.ticks.y=</span><span class="fu">element_blank</span>(),                    </span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>                    <span class="at">panel.grid.major.y=</span><span class="fu">element_blank</span>())</span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>zp1a <span class="ot">&lt;-</span> zp1a <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse=</span><span class="cn">TRUE</span>))</span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>zp1a <span class="ot">&lt;-</span> zp1a <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>zp1b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span> lcmodel_wo_na, <span class="fu">aes</span>(<span class="at">x =</span> L2, <span class="at">y =</span> value, <span class="at">fill =</span> Var2, <span class="at">label=</span>lab2))</span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>zp1b <span class="ot">&lt;-</span> zp1b <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"stack"</span>)</span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a><span class="co">#zp1b &lt;- zp1b + geom_text(position = position_stack(vjust = 0.5), size=3)  # add labels</span></span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>zp1b <span class="ot">&lt;-</span> zp1b <span class="sc">+</span> <span class="fu">facet_grid</span>(Var1 <span class="sc">~</span> .) </span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>zp1b <span class="ot">&lt;-</span> zp1b <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">paste0</span>(<span class="st">"grey"</span>,<span class="fu">seq</span>(<span class="dv">20</span>,<span class="dv">80</span>, <span class="at">by=</span><span class="dv">60</span><span class="sc">/</span><span class="dv">6</span>))) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>zp1b <span class="ot">&lt;-</span> zp1b <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Probabilidad de respuesta"</span>, </span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span><span class="st">"Cateorías de</span><span class="sc">\n</span><span class="st">Respuesta"</span>)</span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>zp1b <span class="ot">&lt;-</span> zp1b <span class="sc">+</span> <span class="fu">theme</span>( <span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>                    <span class="at">axis.ticks.y=</span><span class="fu">element_blank</span>(),                    </span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>                    <span class="at">panel.grid.major.y=</span><span class="fu">element_blank</span>())</span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>zp1b <span class="ot">&lt;-</span> zp1b <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse=</span><span class="cn">TRUE</span>))</span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>zp1b <span class="ot">&lt;-</span> zp1b <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"zp1.png"</span>, zp1b<span class="sc">+</span>ggrepel<span class="sc">::</span><span class="fu">geom_label_repel</span>(<span class="at">data=</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(lcmodel_wo_na,<span class="sc">!</span>CATEGORIA<span class="sc">==</span><span class="st">"Perdidos"</span>),<span class="co">#aes(#y=half, label=lab),</span></span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a>      <span class="co">#position = position_dodge(width = .5),    # move to center of bars</span></span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a>              <span class="co">#vjust = 0,    # nudge above top of bar</span></span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a>  <span class="co">#position = position_stack(vjust = 0.5),</span></span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a>            <span class="co">#position = position_dodge(width = .8),</span></span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true" tabindex="-1"></a>            <span class="co">#vjust = .1,</span></span>
<span id="cb25-69"><a href="#cb25-69" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb25-70"><a href="#cb25-70" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb25-71"><a href="#cb25-71" aria-hidden="true" tabindex="-1"></a>            <span class="at">max.iter =</span> <span class="fl">1e6</span>,</span>
<span id="cb25-72"><a href="#cb25-72" aria-hidden="true" tabindex="-1"></a>            <span class="co">#direction = "y",</span></span>
<span id="cb25-73"><a href="#cb25-73" aria-hidden="true" tabindex="-1"></a>            <span class="co">#force=1,</span></span>
<span id="cb25-74"><a href="#cb25-74" aria-hidden="true" tabindex="-1"></a>            <span class="co">#seed=123,</span></span>
<span id="cb25-75"><a href="#cb25-75" aria-hidden="true" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">"white"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>)<span class="sc">+</span><span class="fu">theme</span>(<span class="at">legend.position=</span> <span class="st">"none"</span>), <span class="at">height=</span><span class="dv">13</span>)<span class="co">#, fill = "white" --&gt; dentro de label repel</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 13 in image</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#ggplotly(zp1a, tooltip = c("text_label"))%&gt;% layout(xaxis= list(showticklabels = T),height=600, width=800) </span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(zp1a, <span class="at">tooltip=</span> <span class="fu">c</span>(<span class="st">"text_label"</span>),<span class="at">height=</span><span class="dv">600</span>, <span class="at">width=</span><span class="dv">800</span>)<span class="sc">%&gt;%</span> <span class="fu">layout</span>(<span class="at">xaxis=</span> <span class="fu">list</span>(<span class="at">showticklabel=</span>T))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="htmlwidget-450b445634ace58771cc" style="width:100%;height:487px;" class="plotly html-widget "></div>
<script type="application/json" data-for="htmlwidget-450b445634ace58771cc">{"x":{"data":[{"orientation":"v","width":[0.90000000000000036,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[1,1.0000000000000002,0.98091566727447155,0.99379112019636606,0.97467191487865512],"x":[3,5,2,4,6],"y":[0,0,0.019084332725528008,0.0062088798036339377,0.025328085121345101],"text":"","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(247,247,247,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(1)","legendgroup":"Pr(1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.90000000000000036,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0.99999999999999822,1.0000000000000024,0.98495080024362902,1.0000000000000013,0.99999999999999756],"x":[3,5,2,4,6],"y":[0,0,0.015049199756370979,0,0],"text":"","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(247,247,247,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(1)","legendgroup":"Pr(1)","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.90000000000000036,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0.99574442574927147,0.96611880999383959,0.97696450360644782,0.99407025118492598,0.98768556975208521],"x":[3,5,2,4,6],"y":[0.0042555742507287553,0.033881190006159523,0.023035496393547183,0.0059297488150722444,0.012314430247912678],"text":"","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(247,247,247,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(1)","legendgroup":"Pr(1)","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.90000000000000036,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0.99278514492907377,0.99980214865490669,0.9709203704961471,0.99781781550483006,0.99877352753493231],"x":[3,5,2,4,6],"y":[0.0072148550709266734,0.00019785134509819891,0.029079629503854676,0.0021821844951710467,0.0012264724650699055],"text":"","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(247,247,247,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(1)","legendgroup":"Pr(1)","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.90000000000000036,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0.99827395921857731,1.0000000000000016,0.99113002628551183,0.99577567906945286,0.99825297294858018],"x":[3,5,2,4,6],"y":[0.0017260407814226886,0,0.0088699737144901647,0.0042243209305478091,0.0017470270514204911],"text":"","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(247,247,247,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(1)","legendgroup":"Pr(1)","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000036,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0.97668487322917863,0.83505506889979064,0.99986641790618247,0,0.4375493779845237,0.96850082138211935],"x":[1,3,5,2,4,6],"y":[0.023315126770820926,0.16494493110020936,0.00013358209381775232,0.98091566727447155,0.55624174221184242,0.0061710934965357733],"text":"","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(217,217,217,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(2)","legendgroup":"Pr(2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000036,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0.80721865787977243,0.99999999999999822,0.074845398779808378,0.6196343122146305,0.28527901413394757,0.190386560181002],"x":[1,3,5,2,4,6],"y":[0.19278134212022979,0,0.92515460122019411,0.36531648802899852,0.7147209858660537,0.80961343981899558],"text":"","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(217,217,217,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(2)","legendgroup":"Pr(2)","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000036,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0.5352874114136924,0.98729291509935879,0.92304496267980018,0.86064933938570742,0.42576883403333632,0.97374029051348909],"x":[1,3,5,2,4,6],"y":[0.46471258858630726,0.0084515106499126746,0.043073847314039404,0.1163151642207404,0.56830141715158966,0.01394527923859612],"text":"","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(217,217,217,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(2)","legendgroup":"Pr(2)","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000036,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0.59615858254765719,0.97480369545062051,3.498150029042367e-08,0.79418410109136661,0.67697235980301329,0.9736996292123925],"x":[1,3,5,2,4,6],"y":[0.40384141745234325,0.01798144947845326,0.99980211367340643,0.17673626940478049,0.32084545570181677,0.025073898322539812],"text":"","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(217,217,217,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(2)","legendgroup":"Pr(2)","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000036,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0.99023065532766463,0.65102571010365862,0.0065122757078537432,0.0034793987725053226,0.61088788095004543,0.92872568878059125],"x":[1,3,5,2,4,6],"y":[0.0097693446723369215,0.34724824911491869,0.99348772429214782,0.98765062751300647,0.38488779811940743,0.069527284167988923],"text":"","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(217,217,217,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(2)","legendgroup":"Pr(2)","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000036,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0.97668484201021044,0.60154502675710453,0,0,0.35055321378936954,0.44602192918028138],"x":[1,3,5,2,4,6],"y":[3.1218968188362339e-08,0.23351004214268611,0.99986641790618247,0,0.086996164195154158,0.52247889220183796],"text":"","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(189,189,189,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(3)","legendgroup":"Pr(3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000036,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[7.5600580421005664e-68,0.95953094337084166,0,0.049856054199839885,0.19309621975954033,0.19038655963376927],"x":[1,3,5,2,4,6],"y":[0.80721865787977243,0.040469056629156563,0.074845398779808378,0.56977825801479065,0.09218279437440724,5.47232731351599e-10],"text":"","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(189,189,189,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(3)","legendgroup":"Pr(3)","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000036,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0,0.81695615549495559,0,0.12677344633536111,0.32068148641537481,0.36511102257766653],"x":[1,3,5,2,4,6],"y":[0.5352874114136924,0.1703367596044032,0.92304496267980018,0.73387589305034628,0.10508734761796151,0.6086292679358225],"text":"","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(189,189,189,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(3)","legendgroup":"Pr(3)","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000036,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[2.7818776122820994e-253,0.76415570340840788,0,0.13476882010659946,0.48379107086883744,0.35096981434567714],"x":[1,3,5,2,4,6],"y":[0.59615858254765719,0.21064799204221263,3.498150029042367e-08,0.65941528098476709,0.19318128893417585,0.6227298148667153],"text":"","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(189,189,189,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(3)","legendgroup":"Pr(3)","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000036,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0.99023065532766463,0.40468327753887645,0,0,0.43618225811806505,0.2051224770718296],"x":[1,3,5,2,4,6],"y":[0,0.24634243256478217,0.0065122757078537432,0.0034793987725053226,0.17470562283198038,0.72360321170876163],"text":"","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(189,189,189,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(3)","legendgroup":"Pr(3)","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0,0.15007045267982191,0,0.33393108287029927,0.27913918970586116],"x":[1,3,2,4,6],"y":[0.97668484201021044,0.45147457407728264,0,0.016622130919070277,0.16688273947442023],"text":"","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(150,150,150,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(4)","legendgroup":"Pr(4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0,0.53404039334230902,0,0.13754332531386015,0.006513866943437259],"x":[1,3,2,4,6],"y":[7.5600580421005664e-68,0.42549055002853264,0.049856054199839885,0.055552894445680179,0.18387269269033202],"text":"","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(150,150,150,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(4)","legendgroup":"Pr(4)","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0,0.31442251138610228,0,0.26129882560589124,0.077968018138981368],"x":[1,3,2,4,6],"y":[0,0.50253364410885326,0.12677344633536111,0.059382660809483567,0.28714300443868518],"text":"","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(150,150,150,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(4)","legendgroup":"Pr(4)","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0,0.30706288693862632,0,0.28343553273618222,0.0035938005823469422],"x":[1,3,2,4,6],"y":[2.7818776122820994e-253,0.45709281646978156,0.13476882010659946,0.20035553813265522,0.34737601376333022],"text":"","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(150,150,150,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(4)","legendgroup":"Pr(4)","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0,0.10891687905943064,0,0.29095899325591557,0.0052991711353165697],"x":[1,3,2,4,6],"y":[0.99023065532766463,0.2957663984794458,0,0.14522326486214948,0.19982330593651301],"text":"","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(150,150,150,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(4)","legendgroup":"Pr(4)","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.90000000000000036,0.90000000000000036,0.90000000000000036],"base":[0,0.03789127725323696,0],"x":[3,4,6],"y":[0.15007045267982191,0.29603980561706233,0.27913918970586116],"text":"","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(99,99,99,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(5)","legendgroup":"Pr(5)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.90000000000000036,0.90000000000000036,0.90000000000000036],"base":[0,0.06770916429032442,0],"x":[3,4,6],"y":[0.53404039334230902,0.069834161023535735,0.006513866943437259],"text":"","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(99,99,99,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(5)","legendgroup":"Pr(5)","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.90000000000000036,0.90000000000000036,0.90000000000000036],"base":[0,0.052999998151853682,0],"x":[3,4,6],"y":[0.31442251138610228,0.20829882745403755,0.077968018138981368],"text":"","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(99,99,99,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(5)","legendgroup":"Pr(5)","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.90000000000000036,0.90000000000000036,0.90000000000000036],"base":[0,0.18988826156827868,0],"x":[3,4,6],"y":[0.30706288693862632,0.09354727116790354,0.0035938005823469422],"text":"","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(99,99,99,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(5)","legendgroup":"Pr(5)","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.90000000000000036,0.90000000000000036,0.90000000000000036],"base":[0,0.20480393765365434,0],"x":[3,4,6],"y":[0.10891687905943064,0.086155055602261221,0.0052991711353165697],"text":"","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(99,99,99,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(5)","legendgroup":"Pr(5)","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[4],"y":[0.03789127725323696],"text":"","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(37,37,37,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(6)","legendgroup":"Pr(6)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[4],"y":[0.06770916429032442],"text":"","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(37,37,37,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(6)","legendgroup":"Pr(6)","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[4],"y":[0.052999998151853682],"text":"","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(37,37,37,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(6)","legendgroup":"Pr(6)","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[4],"y":[0.18988826156827868],"text":"","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(37,37,37,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(6)","legendgroup":"Pr(6)","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[4],"y":[0.20480393765365434],"text":"","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(37,37,37,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(6)","legendgroup":"Pr(6)","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":37.430745814307471,"r":18.99543378995434,"b":25.083713850837146,"l":25.570776255707766},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,6.5999999999999996],"tickmode":"array","ticktext":["Causal","Edad Gestacional<br />(EG) Hito 1","Edad persona<br />gestante","Macrozona","País de origen","Previsión y<br />tramo"],"tickvals":[1,2,3,3.9999999999999996,5,6],"categoryorder":"array","categoryarray":["Causal","Edad Gestacional<br />(EG) Hito 1","Edad persona<br />gestante","Macrozona","País de origen","Previsión y<br />tramo"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-30,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y5","title":"","hoverformat":".2f","showticklabel":true},"yaxis":{"domain":[0.80913242009132424,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.050000000000000246,1.0500000000000052],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25000000000000006,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"annotations":[{"text":"Porcentaje de probabilidad de respuesta","x":0,"y":0.5,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xref":"paper","yref":"paper","textangle":-90,"xanchor":"right","yanchor":"center","annotationType":"axis","xshift":-7.3059360730593621},{"text":"Clase 1: ","x":1,"y":0.90456621004566218,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"Clase 2: ","x":1,"y":0.69999999999999996,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"Clase 3: ","x":1,"y":0.49999999999999994,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"Clase 4: ","x":1,"y":0.29999999999999993,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"Clase 5: ","x":1,"y":0.095433789954337878,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"}],"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.80913242009132424,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.80913242009132424,"y1":1,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.60913242009132418,"y1":0.79086757990867584},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.60913242009132418,"y1":0.79086757990867584,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.40913242009132411,"y1":0.59086757990867578},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.40913242009132411,"y1":0.59086757990867578,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.20913242009132416,"y1":0.39086757990867571},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.20913242009132416,"y1":0.39086757990867571,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":0.19086757990867576},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0,"y1":0.19086757990867576,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"}],"yaxis2":{"type":"linear","autorange":false,"range":[-0.050000000000000246,1.0500000000000052],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25000000000000006,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"domain":[0.60913242009132418,0.79086757990867584],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis3":{"type":"linear","autorange":false,"range":[-0.050000000000000246,1.0500000000000052],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25000000000000006,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"domain":[0.40913242009132411,0.59086757990867578],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis4":{"type":"linear","autorange":false,"range":[-0.050000000000000246,1.0500000000000052],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25000000000000006,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"domain":[0.20913242009132416,0.39086757990867571],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis5":{"type":"linear","autorange":false,"range":[-0.050000000000000246,1.0500000000000052],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25000000000000006,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"domain":[0,0.19086757990867576],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Cateorías de<br />Respuesta","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","width":800,"height":600,"barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"602026baa7":{"x":{},"y":{},"fill":{},"label":{},"type":"bar"}},"cur_data":"602026baa7","visdat":{"602026baa7":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Distribución de categorías del modelo</p>
</div>
</div>
<p><br>
</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>lcmodel_adj_wo_na<span class="ot">&lt;-</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>lcmodel_adj <span class="sc">%&gt;%</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                 dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(CATEGORIA)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                 dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Var1=</span><span class="fu">str_replace</span>(Var1,<span class="st">"class"</span>,<span class="st">"Clase"</span>),</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">L2=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(L2<span class="sc">==</span><span class="st">"CAUSAL"</span><span class="sc">~</span> <span class="st">"Causal"</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                                      L2<span class="sc">==</span><span class="st">"EDAD_MUJER_REC"</span><span class="sc">~</span> <span class="st">"Edad persona</span><span class="sc">\n</span><span class="st">gestante"</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>                                      L2<span class="sc">==</span><span class="st">"MACROZONA"</span><span class="sc">~</span> <span class="st">"Macrozona"</span>,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>                                      L2<span class="sc">==</span><span class="st">"HITO1_EDAD_GEST_SEM_REC"</span><span class="sc">~</span> <span class="st">"Edad Gestacional</span><span class="sc">\n</span><span class="st">(EG) Hito 1"</span>,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>                                      L2<span class="sc">==</span><span class="st">"PREV_TRAMO_REC"</span><span class="sc">~</span> <span class="st">"Previsión y</span><span class="sc">\n</span><span class="st">tramo"</span>,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>                                    L2<span class="sc">==</span><span class="st">"PAIS_ORIGEN_REC"</span><span class="sc">~</span> <span class="st">"País de origen"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">CATEGORIA=</span> <span class="fu">gsub</span>(<span class="st">"1.0-13 semanas"</span>,<span class="st">"1. &lt;=13 semanas"</span>,CATEGORIA)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">CATEGORIA=</span> <span class="fu">gsub</span>(<span class="st">"CENTRO"</span>,<span class="st">"Centro"</span>,CATEGORIA)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">CATEGORIA=</span> <span class="fu">gsub</span>(<span class="st">"CENTRO NORTE"</span>,<span class="st">"Centro norte"</span>,CATEGORIA)) <span class="sc">%&gt;%</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">CATEGORIA=</span> <span class="fu">gsub</span>(<span class="st">"CENTRO SUR"</span>,<span class="st">"Centro sur"</span>,CATEGORIA)) <span class="sc">%&gt;%</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">CATEGORIA=</span> <span class="fu">gsub</span>(<span class="st">"NORTE"</span>,<span class="st">"Norte"</span>,CATEGORIA)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">CATEGORIA=</span> <span class="fu">gsub</span>(<span class="st">"SUR"</span>,<span class="st">"Sur"</span>,CATEGORIA)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">CATEGORIA=</span> <span class="fu">gsub</span>(<span class="st">"25-35"</span>,<span class="st">"25-34"</span>,CATEGORIA)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">CATEGORIA=</span> <span class="fu">gsub</span>(<span class="st">"25-35"</span>,<span class="st">"25-34"</span>,CATEGORIA)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">CATEGORIA=</span> <span class="fu">gsub</span>(<span class="st">"25-35"</span>,<span class="st">"25-34"</span>,CATEGORIA)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">CATEGORIA=</span> <span class="fu">gsub</span>(<span class="st">"25-35"</span>,<span class="st">"25-34"</span>,CATEGORIA)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">CATEGORIA=</span> <span class="fu">gsub</span>(<span class="st">"25-35"</span>,<span class="st">"25-34"</span>,CATEGORIA)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">lab2=</span>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{stringr::str_replace(CATEGORIA,' ','</span><span class="sc">\n</span><span class="st">')}</span><span class="sc">\n</span><span class="st">({scales::percent(value)})"</span>))</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a><span class="co">#2023-09-24</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>lcmodel_adj_wo_na<span class="sc">$</span>text_label_pre<span class="ot">&lt;-</span><span class="fu">paste0</span>(<span class="st">"Categoria:"</span>,lcmodel_adj_wo_na<span class="sc">$</span>CATEGORIA,<span class="st">"&lt;br&gt;%: "</span>,scales<span class="sc">::</span><span class="fu">percent</span>(lcmodel_adj_wo_na<span class="sc">$</span>value))</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>zp2a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(lcmodel_adj_wo_na,<span class="fu">aes</span>(<span class="at">x =</span> L2, <span class="at">y =</span> value, <span class="at">fill =</span> Var2, <span class="at">label=</span>text_label))</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>zp2a <span class="ot">&lt;-</span> zp2a <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"stack"</span>)</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>zp2a <span class="ot">&lt;-</span> zp2a <span class="sc">+</span> <span class="fu">facet_grid</span>(Var1 <span class="sc">~</span> .) </span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>zp2a <span class="ot">&lt;-</span> zp2a <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">type=</span><span class="st">"seq"</span>, <span class="at">palette=</span><span class="st">"Greys"</span>, <span class="at">na.value =</span> <span class="st">"white"</span>) <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>zp2a <span class="ot">&lt;-</span> zp2a <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Porcentaje de probabilidad de respuesta"</span>, </span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span><span class="st">"Cateorías de</span><span class="sc">\n</span><span class="st">Respuesta"</span>)</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>zp2a <span class="ot">&lt;-</span> zp2a <span class="sc">+</span> <span class="fu">theme</span>( <span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>                    <span class="at">axis.ticks.y=</span><span class="fu">element_blank</span>(),                    </span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>                    <span class="at">panel.grid.major.y=</span><span class="fu">element_blank</span>())</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>zp2a <span class="ot">&lt;-</span> zp2a <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse=</span><span class="cn">TRUE</span>))</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>zp2a <span class="ot">&lt;-</span> zp2a <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>zp2a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Paso4_files/figure-html/clasificaciones-res-distal-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Distribución de categorías del modelo ajustado</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(zp2a, <span class="at">tooltip=</span> <span class="fu">c</span>(<span class="st">"text_label"</span>),<span class="at">height=</span><span class="dv">600</span>, <span class="at">width=</span><span class="dv">800</span>)<span class="sc">%&gt;%</span> <span class="fu">layout</span>(<span class="at">xaxis=</span> <span class="fu">list</span>(<span class="at">showticklabel=</span>T))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="htmlwidget-793b3b28f2f13d747783" style="width:100%;height:487px;" class="plotly html-widget "></div>
<script type="application/json" data-for="htmlwidget-793b3b28f2f13d747783">{"x":{"data":[{"orientation":"v","width":[0.90000000000000036,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0.99826458991361577,1.0000000000000024,0.99121981100125045,0.99617444518102127,0.99824705730492624],"x":[3,5,2,4,6],"y":[0.0017354100863835598,0,0.0087801889987528803,0.0038255548189782829,0.0017529426950755322],"text":["text_label: Categoria:Perdidos<br>%: 0%","text_label: Categoria:Perdidos<br>%: 0%","text_label: Categoria:Perdidos<br>%: 1%","text_label: Categoria:Perdidos<br>%: 0%","text_label: Categoria:Perdidos<br>%: 0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(247,247,247,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(1)","legendgroup":"Pr(1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.90000000000000036,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[1.0000000000000004,0.98793327567362987,0.97961872121104721,1.0000000000000009,0.99023267859052899],"x":[3,5,2,4,6],"y":[0,0.012066724326369904,0.020381278788950574,0,0.0097673214094710081],"text":["text_label: Categoria:Perdidos<br>%: 0%","text_label: Categoria:Perdidos<br>%: 1%","text_label: Categoria:Perdidos<br>%: 2%","text_label: Categoria:Perdidos<br>%: 0%","text_label: Categoria:Perdidos<br>%: 1%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(247,247,247,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(1)","legendgroup":"Pr(1)","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.90000000000000036,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0.99179184849361446,0.99407163228008899,0.97101183690784698,0.99623657290412071,0.99795943999400372],"x":[3,5,2,4,6],"y":[0.0082081515063866517,0.0059283677199132301,0.028988163092154129,0.0037634270958795124,0.0020405600059960616],"text":["text_label: Categoria:Perdidos<br>%: 1%","text_label: Categoria:Perdidos<br>%: 1%","text_label: Categoria:Perdidos<br>%: 3%","text_label: Categoria:Perdidos<br>%: 0%","text_label: Categoria:Perdidos<br>%: 0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(247,247,247,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(1)","legendgroup":"Pr(1)","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.90000000000000036,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0.99999999999999967,1.0000000000000004,0.98080459069148163,0.99380385605084842,0.97442360729544775],"x":[3,5,2,4,6],"y":[0,0,0.01919540930851904,0.0061961439491514669,0.025576392704552253],"text":["text_label: Categoria:Perdidos<br>%: 0%","text_label: Categoria:Perdidos<br>%: 0%","text_label: Categoria:Perdidos<br>%: 2%","text_label: Categoria:Perdidos<br>%: 1%","text_label: Categoria:Perdidos<br>%: 3%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(247,247,247,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(1)","legendgroup":"Pr(1)","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.90000000000000036,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0.99999999999999867,1.0000000000000038,0.98193897916623818,0.99999999999999878,0.99999999999999767],"x":[3,5,2,4,6],"y":[0,0,0.018061020833761376,0,0],"text":["text_label: Categoria:Perdidos<br>%: 0%","text_label: Categoria:Perdidos<br>%: 0%","text_label: Categoria:Perdidos<br>%: 2%","text_label: Categoria:Perdidos<br>%: 0%","text_label: Categoria:Perdidos<br>%: 0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(247,247,247,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(1)","legendgroup":"Pr(1)","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000036,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0.99511621775022874,0.64993513019298976,0.0067172580193274713,0.0034846251248384875,0.6111975718116569,0.92858628440765589],"x":[1,3,5,2,4,6],"y":[0.004883782249774371,0.34832945972062601,0.99328274198067501,0.98773518587641196,0.38497687336936437,0.069660772897270351],"text":["text_label: Categoria:Causal 1<br>%: 0%","text_label: Categoria:1.<18<br>%: 35%","text_label: Categoria:Chileno<br>%: 99%","text_label: Categoria:1.0-13 semanas<br>%: 99%","text_label: Categoria:CENTRO<br>%: 38%","text_label: Categoria:ISAPRE y FFAA<br>%: 7%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(217,217,217,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(2)","legendgroup":"Pr(2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000036,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0.53737969514965045,0.99110961814274601,0.98682034561579057,0.8654775801479635,0.43397831514920665,0.9895790362998601],"x":[1,3,5,2,4,6],"y":[0.46262030485034955,0.0088903818572544369,0.0011129300578393009,0.11414114106308371,0.56602168485079418,0.00065364229066888768],"text":["text_label: Categoria:Causal 1<br>%: 46%","text_label: Categoria:1.<18<br>%: 1%","text_label: Categoria:Chileno<br>%: 0%","text_label: Categoria:1.0-13 semanas<br>%: 11%","text_label: Categoria:CENTRO<br>%: 57%","text_label: Categoria:ISAPRE y FFAA<br>%: 0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(217,217,217,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(2)","legendgroup":"Pr(2)","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000036,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0.59317109031127913,0.97371962578864013,1.056816251505501e-16,0.79771831591321885,0.67591644217851321,0.96745852071371963],"x":[1,3,5,2,4,6],"y":[0.40682890968872132,0.018072222704974328,0.99407163228008888,0.17329352099462814,0.3203201307256075,0.030500919280284089],"text":["text_label: Categoria:Causal 1<br>%: 41%","text_label: Categoria:1.<18<br>%: 2%","text_label: Categoria:Chileno<br>%: 99%","text_label: Categoria:1.0-13 semanas<br>%: 17%","text_label: Categoria:CENTRO<br>%: 32%","text_label: Categoria:ISAPRE y FFAA<br>%: 3%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(217,217,217,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(2)","legendgroup":"Pr(2)","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000036,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0.97532469995557303,0.8351570757002974,0.99724864461715657,0,0.43779172955678214,0.96827449180948],"x":[1,3,5,2,4,6],"y":[0.02467530004442875,0.16484292429970226,0.0027513553828438786,0.98080459069148163,0.55601212649406628,0.0061491154859677488],"text":["text_label: Categoria:Causal 1<br>%: 2%","text_label: Categoria:1.<18<br>%: 16%","text_label: Categoria:Chileno<br>%: 0%","text_label: Categoria:1.0-13 semanas<br>%: 98%","text_label: Categoria:CENTRO<br>%: 56%","text_label: Categoria:ISAPRE y FFAA<br>%: 1%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(217,217,217,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(2)","legendgroup":"Pr(2)","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000036,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0.79788891938689332,0.99999999999999867,0.09307117692584653,0.61165834513381967,0.27948175262683045,0.24219013548705778],"x":[1,3,5,2,4,6],"y":[0.20211108061310978,0,0.90692882307415723,0.37028063403241851,0.72051824737316839,0.75780986451293986],"text":["text_label: Categoria:Causal 1<br>%: 20%","text_label: Categoria:1.<18<br>%: 0%","text_label: Categoria:Chileno<br>%: 91%","text_label: Categoria:1.0-13 semanas<br>%: 37%","text_label: Categoria:CENTRO<br>%: 72%","text_label: Categoria:ISAPRE y FFAA<br>%: 76%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(217,217,217,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(2)","legendgroup":"Pr(2)","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000036,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0.99511621775022874,0.4039105436040254,0,0,0.43605537987562659,0.20476298871331047],"x":[1,3,5,2,4,6],"y":[0,0.24602458658896437,0.0067172580193274713,0.0034846251248384875,0.17514219193603031,0.72382329569434545],"text":["text_label: Categoria:Causal 2<br>%: 0%","text_label: Categoria:2.18-24<br>%: 25%","text_label: Categoria:Otro<br>%: 1%","text_label: Categoria:2.14-27 semanas<br>%: 0%","text_label: Categoria:CENTRO NORTE<br>%: 18%","text_label: Categoria:FONASA A/B<br>%: 72%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(189,189,189,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(3)","legendgroup":"Pr(3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000036,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0,0.81642406195138484,0,0.12941772727014095,0.32795984212919715,0.36355929008128118],"x":[1,3,5,2,4,6],"y":[0.53737969514965045,0.17468555619136117,0.98682034561579057,0.73605985287782261,0.1060184730200095,0.62601974621857892],"text":["text_label: Categoria:Causal 2<br>%: 54%","text_label: Categoria:2.18-24<br>%: 17%","text_label: Categoria:Otro<br>%: 99%","text_label: Categoria:2.14-27 semanas<br>%: 74%","text_label: Categoria:CENTRO NORTE<br>%: 11%","text_label: Categoria:FONASA A/B<br>%: 63%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(189,189,189,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(3)","legendgroup":"Pr(3)","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000036,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0,0.76230171952322257,0,0.13741366161132865,0.48406951695105893,0.34203863160849202],"x":[1,3,5,2,4,6],"y":[0.59317109031127913,0.21141790626541757,1.056816251505501e-16,0.66030465430189023,0.19184692522745428,0.62541988910522761],"text":["text_label: Categoria:Causal 2<br>%: 59%","text_label: Categoria:2.18-24<br>%: 21%","text_label: Categoria:Otro<br>%: 0%","text_label: Categoria:2.14-27 semanas<br>%: 66%","text_label: Categoria:CENTRO NORTE<br>%: 19%","text_label: Categoria:FONASA A/B<br>%: 63%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(189,189,189,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(3)","legendgroup":"Pr(3)","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000036,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0.97528513290630525,0.60201735775396625,0,0,0.35072811145261512,0.44689714778501088],"x":[1,3,5,2,4,6],"y":[3.9567049267774657e-05,0.23313971794633115,0.99724864461715657,0,0.087063618104167018,0.52137734402446911],"text":["text_label: Categoria:Causal 2<br>%: 0%","text_label: Categoria:2.18-24<br>%: 23%","text_label: Categoria:Otro<br>%: 100%","text_label: Categoria:2.14-27 semanas<br>%: 0%","text_label: Categoria:CENTRO NORTE<br>%: 9%","text_label: Categoria:FONASA A/B<br>%: 52%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(189,189,189,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(3)","legendgroup":"Pr(3)","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000036,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[2.4666460433996271e-215,0.96073946319083148,0,0.039601776592232171,0.18578492985037959,0.23722477223585636],"x":[1,3,5,2,4,6],"y":[0.79788891938689332,0.03926053680916719,0.09307117692584653,0.57205656854158748,0.093696822776450861,0.0049653632512014212],"text":["text_label: Categoria:Causal 2<br>%: 80%","text_label: Categoria:2.18-24<br>%: 4%","text_label: Categoria:Otro<br>%: 9%","text_label: Categoria:2.14-27 semanas<br>%: 57%","text_label: Categoria:CENTRO NORTE<br>%: 9%","text_label: Categoria:FONASA A/B<br>%: 0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(189,189,189,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(3)","legendgroup":"Pr(3)","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0,0.10882580037970137,0,0.2908027853594326,0.0051206857954066405],"x":[1,3,2,4,6],"y":[0.99511621775022874,0.29508474322432404,0,0.14525259451619399,0.19964230291790383],"text":["text_label: Categoria:Causal 3<br>%: 100%","text_label: Categoria:3.25-35<br>%: 30%","text_label: Categoria:3.>=28 semanas<br>%: 0%","text_label: Categoria:CENTRO SUR<br>%: 15%","text_label: Categoria:FONASA C/D<br>%: 20%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(150,150,150,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(4)","legendgroup":"Pr(4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0,0.31419038711844893,0,0.26569229843175018,0.081669961190076121],"x":[1,3,2,4,6],"y":[0,0.50223367483293591,0.12941772727014095,0.06226754369744697,0.28188932889120505],"text":["text_label: Categoria:Causal 3<br>%: 0%","text_label: Categoria:3.25-35<br>%: 50%","text_label: Categoria:3.>=28 semanas<br>%: 13%","text_label: Categoria:CENTRO SUR<br>%: 6%","text_label: Categoria:FONASA C/D<br>%: 28%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(150,150,150,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(4)","legendgroup":"Pr(4)","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0,0.30599417633199327,0,0.2842064114299242,0.0036569960642227617],"x":[1,3,2,4,6],"y":[0,0.45630754319122929,0.13741366161132865,0.19986310552113473,0.33838163554426925],"text":["text_label: Categoria:Causal 3<br>%: 0%","text_label: Categoria:3.25-35<br>%: 46%","text_label: Categoria:3.>=28 semanas<br>%: 14%","text_label: Categoria:CENTRO SUR<br>%: 20%","text_label: Categoria:FONASA C/D<br>%: 34%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(150,150,150,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(4)","legendgroup":"Pr(4)","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0,0.1508745283851301,0,0.33422462411148035,0.27953137519323051],"x":[1,3,2,4,6],"y":[0.97528513290630525,0.45114282936883615,0,0.01650348734113477,0.16736577259178037],"text":["text_label: Categoria:Causal 3<br>%: 98%","text_label: Categoria:3.25-35<br>%: 45%","text_label: Categoria:3.>=28 semanas<br>%: 0%","text_label: Categoria:CENTRO SUR<br>%: 2%","text_label: Categoria:FONASA C/D<br>%: 17%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(150,150,150,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(4)","legendgroup":"Pr(4)","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000036,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0,0.52615202340954303,0,0.13603498296479838,0.0090666416422376158],"x":[1,3,2,4,6],"y":[2.4666460433996271e-215,0.43458743978128844,0.039601776592232171,0.049749946885581209,0.22815813059361875],"text":["text_label: Categoria:Causal 3<br>%: 0%","text_label: Categoria:3.25-35<br>%: 43%","text_label: Categoria:3.>=28 semanas<br>%: 4%","text_label: Categoria:CENTRO SUR<br>%: 5%","text_label: Categoria:FONASA C/D<br>%: 23%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(150,150,150,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(4)","legendgroup":"Pr(4)","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.90000000000000036,0.90000000000000036,0.90000000000000036],"base":[0,0.20480054331352518,0],"x":[3,4,6],"y":[0.10882580037970137,0.086002242045907423,0.0051206857954066405],"text":["text_label: Categoria:4.>=35<br>%: 11%","text_label: Categoria:NORTE<br>%: 9%","text_label: Categoria:NINGUNA<br>%: 1%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(99,99,99,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(5)","legendgroup":"Pr(5)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.90000000000000036,0.90000000000000036,0.90000000000000036],"base":[0,0.051006264392568758,0],"x":[3,4,6],"y":[0.31419038711844893,0.21468603403918143,0.081669961190076121],"text":["text_label: Categoria:4.>=35<br>%: 31%","text_label: Categoria:NORTE<br>%: 21%","text_label: Categoria:NINGUNA<br>%: 8%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(99,99,99,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(5)","legendgroup":"Pr(5)","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.90000000000000036,0.90000000000000036,0.90000000000000036],"base":[0,0.18936122179061265,0],"x":[3,4,6],"y":[0.30599417633199327,0.094845189639311545,0.0036569960642227617],"text":["text_label: Categoria:4.>=35<br>%: 31%","text_label: Categoria:NORTE<br>%: 9%","text_label: Categoria:NINGUNA<br>%: 0%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(99,99,99,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(5)","legendgroup":"Pr(5)","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.90000000000000036,0.90000000000000036,0.90000000000000036],"base":[0,0.038499837268499322,0],"x":[3,4,6],"y":[0.1508745283851301,0.29572478684298104,0.27953137519323051],"text":["text_label: Categoria:4.>=35<br>%: 15%","text_label: Categoria:NORTE<br>%: 30%","text_label: Categoria:NINGUNA<br>%: 28%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(99,99,99,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(5)","legendgroup":"Pr(5)","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.90000000000000036,0.90000000000000036,0.90000000000000036],"base":[0,0.066002760396522017,0],"x":[3,4,6],"y":[0.52615202340954303,0.070032222568276362,0.0090666416422376158],"text":["text_label: Categoria:4.>=35<br>%: 53%","text_label: Categoria:NORTE<br>%: 7%","text_label: Categoria:NINGUNA<br>%: 1%"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(99,99,99,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(5)","legendgroup":"Pr(5)","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[4],"y":[0.20480054331352518],"text":"text_label: Categoria:SUR<br>%: 20%","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(37,37,37,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(6)","legendgroup":"Pr(6)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[4],"y":[0.051006264392568758],"text":"text_label: Categoria:SUR<br>%: 5%","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(37,37,37,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(6)","legendgroup":"Pr(6)","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[4],"y":[0.18936122179061265],"text":"text_label: Categoria:SUR<br>%: 19%","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(37,37,37,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(6)","legendgroup":"Pr(6)","showlegend":false,"xaxis":"x","yaxis":"y3","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[4],"y":[0.038499837268499322],"text":"text_label: Categoria:SUR<br>%: 4%","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(37,37,37,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(6)","legendgroup":"Pr(6)","showlegend":false,"xaxis":"x","yaxis":"y4","hoverinfo":"text","frame":null},{"orientation":"v","width":0.90000000000000036,"base":0,"x":[4],"y":[0.066002760396522017],"text":"text_label: Categoria:SUR<br>%: 7%","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(37,37,37,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Pr(6)","legendgroup":"Pr(6)","showlegend":false,"xaxis":"x","yaxis":"y5","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":37.430745814307471,"r":18.99543378995434,"b":25.083713850837146,"l":25.570776255707766},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,6.5999999999999996],"tickmode":"array","ticktext":["Causal","Edad Gestacional<br />(EG) Hito 1","Edad persona<br />gestante","Macrozona","País de origen","Previsión y<br />tramo"],"tickvals":[1,2,3,3.9999999999999996,5,6],"categoryorder":"array","categoryarray":["Causal","Edad Gestacional<br />(EG) Hito 1","Edad persona<br />gestante","Macrozona","País de origen","Previsión y<br />tramo"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-30,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y5","title":"","hoverformat":".2f","showticklabel":true},"yaxis":{"domain":[0.80913242009132424,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.05000000000000019,1.050000000000004],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.49999999999999994,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"annotations":[{"text":"Porcentaje de probabilidad de respuesta","x":0,"y":0.5,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xref":"paper","yref":"paper","textangle":-90,"xanchor":"right","yanchor":"center","annotationType":"axis","xshift":-7.3059360730593621},{"text":"Clase 1: ","x":1,"y":0.90456621004566218,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"Clase 2: ","x":1,"y":0.69999999999999996,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"Clase 3: ","x":1,"y":0.49999999999999994,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"Clase 4: ","x":1,"y":0.29999999999999993,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"},{"text":"Clase 5: ","x":1,"y":0.095433789954337878,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.68949771689498},"xref":"paper","yref":"paper","textangle":90,"xanchor":"left","yanchor":"middle"}],"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.80913242009132424,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.80913242009132424,"y1":1,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.60913242009132418,"y1":0.79086757990867584},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.60913242009132418,"y1":0.79086757990867584,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.40913242009132411,"y1":0.59086757990867578},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.40913242009132411,"y1":0.59086757990867578,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0.20913242009132416,"y1":0.39086757990867571},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0.20913242009132416,"y1":0.39086757990867571,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"},{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":0.19086757990867576},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","y0":0,"y1":0.19086757990867576,"x0":0,"x1":23.37899543378996,"xanchor":1,"xsizemode":"pixel"}],"yaxis2":{"type":"linear","autorange":false,"range":[-0.05000000000000019,1.050000000000004],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.49999999999999994,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"domain":[0.60913242009132418,0.79086757990867584],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis3":{"type":"linear","autorange":false,"range":[-0.05000000000000019,1.050000000000004],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.49999999999999994,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"domain":[0.40913242009132411,0.59086757990867578],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis4":{"type":"linear","autorange":false,"range":[-0.05000000000000019,1.050000000000004],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.49999999999999994,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"domain":[0.20913242009132416,0.39086757990867571],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"yaxis5":{"type":"linear","autorange":false,"range":[-0.05000000000000019,1.050000000000004],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.49999999999999994,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"domain":[0,0.19086757990867576],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Cateorías de<br />Respuesta","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","width":800,"height":600,"barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"60203c881b77":{"x":{},"y":{},"fill":{},"label":{},"type":"bar"}},"cur_data":"60203c881b77","visdat":{"60203c881b77":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>zp1_tab<span class="ot">&lt;-</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>lcmodel <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Var1, L2, CATEGORIA, pr, value) <span class="sc">%&gt;%</span> </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">id_cols =</span><span class="fu">c</span>(L2,pr,CATEGORIA), <span class="at">names_from =</span> Var1, <span class="at">values_from=</span>value) <span class="sc">%&gt;%</span> </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">"class"</span>),<span class="sc">~</span> <span class="fu">sprintf</span>(<span class="st">"%01.1f"</span>,.<span class="sc">*</span><span class="dv">100</span>)))</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>zp2_tab<span class="ot">&lt;-</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>lcmodel_adj <span class="sc">%&gt;%</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Var1, L2, CATEGORIA, pr, value) <span class="sc">%&gt;%</span> </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">id_cols =</span><span class="fu">c</span>(L2,pr,CATEGORIA),  <span class="at">names_from =</span> Var1, <span class="at">values_from=</span>value) <span class="sc">%&gt;%</span> </span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">"class"</span>),<span class="sc">~</span> <span class="fu">sprintf</span>(<span class="st">"%01.1f"</span>,.<span class="sc">*</span><span class="dv">100</span>)))</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  rio<span class="sc">::</span><span class="fu">export</span>(<span class="fu">list</span>(<span class="at">zp1 =</span> zp1_tab, </span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">zp2_zp1_adj =</span> zp2_tab), <span class="st">"tab_mod_dist_cat.xlsx"</span>, <span class="at">overwrite =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="regresión-logística-polca" class="level2">
<h2 class="anchored" data-anchor-id="regresión-logística-polca">Regresión logística (poLCA)</h2>
<p>Antes, ver relación con resultado de aquellos clasificados en una clase.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(mydata_preds3,LCA_best_model_mod<span class="sc">$</span>predclass) <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    janitor<span class="sc">::</span><span class="fu">tabyl</span>(outcome, <span class="st">`</span><span class="at">LCA_best_model_mod$predclass</span><span class="st">`</span>)<span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    janitor<span class="sc">::</span><span class="fu">adorn_percentages</span>(<span class="st">"col"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate_if</span>(is.numeric, <span class="sc">~</span>scales<span class="sc">::</span><span class="fu">percent</span>(., <span class="at">accuracy=</span><span class="fl">0.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> outcome     1     2     3     4     5
       0  6.2%  7.4% 15.1% 20.9%  8.2%
       1 93.8% 92.6% 84.9% 79.1% 91.8%</code></pre>
</div>
</div>
<p>Con resultado distal</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>df_model_LCA2 <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"prob_c"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span> data.table<span class="sc">::</span><span class="fu">data.table</span>(<span class="at">keep.rownames=</span>T) <span class="sc">%&gt;%</span> </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">rn=</span><span class="fu">gsub</span>(<span class="st">"prob_c"</span>,<span class="st">""</span>,rn)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="st">"markdown"</span>, <span class="at">caption=</span><span class="st">"Probabilidad de pertenecer a una clase, según interrupción del embarazo"</span>, <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Clase"</span>,<span class="st">"No interrumpe"</span>, <span class="st">"Interrumpe"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Probabilidad de pertenecer a una clase, según interrupción del embarazo</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Clase</th>
<th style="text-align: left;">No interrumpe</th>
<th style="text-align: left;">Interrumpe</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">0.19(95%CI=0.16,0.23)</td>
<td style="text-align: left;">0.18(95%CI=0.17,0.19)</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">0.18(95%CI=0.15,0.21)</td>
<td style="text-align: left;">0.15(95%CI=0.14,0.17)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">0.3(95%CI=0.26,0.33)</td>
<td style="text-align: left;">0.39(95%CI=0.37,0.4)</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">0.16(95%CI=0.13,0.19)</td>
<td style="text-align: left;">0.13(95%CI=0.12,0.14)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: left;">0.17(95%CI=0.15,0.21)</td>
<td style="text-align: left;">0.15(95%CI=0.14,0.17)</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="análisis-de-clases-latentes-selección-de-clases-modelo-alternativo-sin-pueblo-originario-y-año-búsqueda-de-clases-análisis-secundario" class="level1">
<h1>Análisis de clases latentes, selección de clases, modelo alternativo, sin pueblo originario y año Búsqueda de clases, Análisis secundario</h1>
<section id="medidas-de-ajuste-polca-y-glca-combinados" class="level2">
<h2 class="anchored" data-anchor-id="medidas-de-ajuste-polca-y-glca-combinados">Medidas de ajuste poLCA y glca, combinados</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"data2_lca3_glca_sin_po_ano.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="controlly">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#rm(list = ls());gc()</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>tab_ppio <span class="sc">%&gt;%</span><span class="co">#</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ModelIndex, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate_if</span>(is.character, as.numeric) <span class="sc">%&gt;%</span> </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">data.frame</span>(bootlrt<span class="sc">$</span>gtable), BIC, entropy, Gsq, Boot.p.value)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_if</span>(is.numeric, <span class="sc">~</span><span class="fu">round</span>(.,<span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(model_index, bic, a_bic, bic, bic_2, rel_ent, ent_r2, entropy, gsq_2, boot_p_value) <span class="ot">-&gt;</span> tab_fit1</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>tab_fit1 <span class="sc">%&gt;%</span> </span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert character columns to numeric</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">format=</span><span class="st">"markdown"</span>, <span class="at">caption=</span><span class="st">"Medidas de ajuste (dividir por 1000 gsq_2)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Medidas de ajuste (dividir por 1000 gsq_2)</caption>
<colgroup>
<col style="width: 14%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">model_index</th>
<th style="text-align: right;">bic</th>
<th style="text-align: right;">a_bic</th>
<th style="text-align: right;">bic_2</th>
<th style="text-align: right;">rel_ent</th>
<th style="text-align: right;">ent_r2</th>
<th style="text-align: right;">entropy</th>
<th style="text-align: right;">gsq_2</th>
<th style="text-align: right;">boot_p_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">45819.78</td>
<td style="text-align: right;">45683.15</td>
<td style="text-align: right;">45803.30</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">2678.89</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">45568.50</td>
<td style="text-align: right;">45361.96</td>
<td style="text-align: right;">45543.78</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">2246.33</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">45399.87</td>
<td style="text-align: right;">45123.42</td>
<td style="text-align: right;">45366.91</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">1896.42</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">45317.18</td>
<td style="text-align: right;">44970.83</td>
<td style="text-align: right;">45275.98</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">1632.46</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">45386.28</td>
<td style="text-align: right;">44970.02</td>
<td style="text-align: right;">45336.84</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.80</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">1520.28</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">45478.47</td>
<td style="text-align: right;">44992.30</td>
<td style="text-align: right;">45420.79</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">1431.19</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: right;">45591.83</td>
<td style="text-align: right;">45035.76</td>
<td style="text-align: right;">45525.91</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: right;">1363.28</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td style="text-align: right;">45703.82</td>
<td style="text-align: right;">45077.85</td>
<td style="text-align: right;">45629.66</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">0.73</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">1293.99</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: right;">45820.84</td>
<td style="text-align: right;">45124.96</td>
<td style="text-align: right;">45738.44</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">1229.74</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="controlly">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>tab_ppio2 <span class="sc">%&gt;%</span><span class="co">#</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ModelIndex, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate_if</span>(is.character, as.numeric) <span class="sc">%&gt;%</span> </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind.data.frame</span>(dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">data.frame</span>(bootlrt2<span class="sc">$</span>gtable), BIC, entropy, Gsq, Boot.p.value)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_if</span>(is.numeric, <span class="sc">~</span><span class="fu">round</span>(.,<span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(model_index, bic, a_bic, bic, bic_2, rel_ent, ent_r2, entropy, gsq_2, boot_p_value) <span class="ot">-&gt;</span> tab_fit2</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>tab_fit2 <span class="sc">%&gt;%</span> </span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert character columns to numeric</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">format=</span><span class="st">"markdown"</span>, <span class="at">caption=</span><span class="st">"Medidas de ajuste (ajustado)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Medidas de ajuste (ajustado)</caption>
<colgroup>
<col style="width: 14%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">model_index</th>
<th style="text-align: right;">bic</th>
<th style="text-align: right;">a_bic</th>
<th style="text-align: right;">bic_2</th>
<th style="text-align: right;">rel_ent</th>
<th style="text-align: right;">ent_r2</th>
<th style="text-align: right;">entropy</th>
<th style="text-align: right;">gsq_2</th>
<th style="text-align: right;">boot_p_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">45776.24</td>
<td style="text-align: right;">45636.43</td>
<td style="text-align: right;">45759.76</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">3536.09</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">45481.98</td>
<td style="text-align: right;">45269.09</td>
<td style="text-align: right;">45457.26</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">0.86</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">3052.32</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">45305.93</td>
<td style="text-align: right;">45019.95</td>
<td style="text-align: right;">45272.97</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">2686.74</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">45230.37</td>
<td style="text-align: right;">44871.31</td>
<td style="text-align: right;">45189.17</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">2421.67</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">45255.46</td>
<td style="text-align: right;">44823.32</td>
<td style="text-align: right;">45195.29</td>
<td style="text-align: right;">0.86</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.86</td>
<td style="text-align: right;">2246.52</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">45447.71</td>
<td style="text-align: right;">44942.48</td>
<td style="text-align: right;">45259.35</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">0.85</td>
<td style="text-align: right;">2129.29</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: right;">45697.24</td>
<td style="text-align: right;">45118.93</td>
<td style="text-align: right;">45333.74</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">2022.41</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td style="text-align: right;">46281.80</td>
<td style="text-align: right;">45630.41</td>
<td style="text-align: right;">45416.50</td>
<td style="text-align: right;">0.85</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">1923.89</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: right;">46669.37</td>
<td style="text-align: right;">45944.89</td>
<td style="text-align: right;">45534.20</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">1860.32</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a> rio<span class="sc">::</span><span class="fu">export</span>(<span class="fu">list</span>(<span class="at">sin_ajustar =</span> tab_fit1, </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ajustado =</span> tab_fit2), <span class="st">"polca_glca_fit_table.xlsx"</span>, <span class="at">overwrite=</span>T)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a> <span class="co">#Masyn is talking about normalized entropy above, which ranges from 0 to 1.</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Masyn, K. (2013). Chapter 25 Latent Class Analysis and Finite Mixture Modeling. The Oxford Handbook of Quantitative Methods. D. Little (eds). https://www.statmodel.com/download/Masyn_2013.pdf</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a> <span class="co">#Vermunt, J. K., &amp; Magidson, J. (2016). Technical guide for Latent GOLD 5.1: Basic, advanced, and syntax. Belmont, MA: Statistical Innovations Inc.</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a> <span class="co">#https://www.google.com/url?q=https://www.statisticalinnovations.com/wp-content/uploads/LGtechnical.pdf&amp;sa=D&amp;source=docs&amp;ust=1689531259723207&amp;usg=AOvVaw2N3g_gco8-GUiiPhRQxRoS</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</section>
<section id="figuras" class="level2">
<h2 class="anchored" data-anchor-id="figuras">Figuras</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="do">##https://agscl.github.io/IVE/Paso36.html</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(plotly)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplotly(zp3, tooltip = c("text_label"))%&gt;% layout(xaxis= list(showticklabels = T),height=600, width=800)</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>zp3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in discrete_range(): no se pudo encontrar la función "discrete_range"</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(zp3, <span class="at">tooltip =</span> <span class="fu">c</span>(<span class="st">"text_label"</span>))<span class="sc">%&gt;%</span> <span class="fu">layout</span>(<span class="at">xaxis=</span> <span class="fu">list</span>(<span class="at">showticklabels =</span> T),<span class="at">height=</span><span class="dv">600</span>, <span class="at">width=</span><span class="dv">800</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in discrete_range(): no se pudo encontrar la función "discrete_range"</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplotly(zp4, tooltip = c("text_label"))%&gt;% layout(xaxis= list(showticklabels = T),height=600, width=800)</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>zp4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in discrete_range(): no se pudo encontrar la función "discrete_range"</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(zp4, <span class="at">tooltip =</span> <span class="fu">c</span>(<span class="st">"text_label"</span>))<span class="sc">%&gt;%</span> <span class="fu">layout</span>(<span class="at">xaxis=</span> <span class="fu">list</span>(<span class="at">showticklabels =</span> T),<span class="at">height=</span><span class="dv">600</span>, <span class="at">width=</span><span class="dv">800</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in discrete_range(): no se pudo encontrar la función "discrete_range"</code></pre>
</div>
</div>
</section>
<section id="regresión-logística-no-distal" class="level2">
<h2 class="anchored" data-anchor-id="regresión-logística-no-distal">Regresión logística (no distal)</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># average_posterior_probability &lt;- mean(poLCA.posterior(LCA_best_model_mod, LCA_best_model_mod$predclass))</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="co"># table(LCA_best_model_mod$predclass)</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="co"># table(posterior_glca_05_final$final_05)</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co"># table(posterior_glca_05_final$final_05,car::recode(posterior_glca_05_final$final_05,"4=1;3=2;3=3;2=4;5=5;NA=NA"))</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="co"># posterior_glca_07_final %&gt;% </span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     rowwise() %&gt;%</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     mutate(count_ones = sum(c_across(starts_with("Class")) == 1)) %&gt;%</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     ungroup() %&gt;% </span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="co">#     janitor::tabyl(final_07,count_ones)</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>mat<span class="ot">&lt;-</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(LCA_best_model_mod<span class="sc">$</span>posterior, <span class="at">y=</span>LCA_best_model_mod<span class="sc">$</span>predclass) <span class="sc">%&gt;%</span> </span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">group_by</span>(y) <span class="sc">%&gt;%</span> </span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span><span class="ot">=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span>), <span class="st">`</span><span class="at">2</span><span class="st">`</span><span class="ot">=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">2</span><span class="st">`</span>), <span class="st">`</span><span class="at">3</span><span class="st">`</span><span class="ot">=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">3</span><span class="st">`</span>), <span class="st">`</span><span class="at">4</span><span class="st">`</span><span class="ot">=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">4</span><span class="st">`</span>), <span class="st">`</span><span class="at">5</span><span class="st">`</span><span class="ot">=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">5</span><span class="st">`</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">mutate_all</span>(<span class="sc">~</span><span class="fu">round</span>(.,<span class="dv">2</span>))</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"mean posterior probabilities: "</span>,</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="fu">diag</span>(<span class="fu">matrix</span>(<span class="fu">unlist</span>(mat), <span class="at">nrow=</span><span class="dv">5</span>)[,<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>]),<span class="at">collapse =</span><span class="st">", "</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "mean posterior probabilities:  0.98, 0.88, 0.98, 0.95, 1"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Classifying by posterior probs.</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>posterior_glca_05_final<span class="ot">&lt;-</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>best_model_glca<span class="sc">$</span>posterior<span class="sc">$</span>ALL <span class="sc">%&gt;%</span> </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate_all</span>(<span class="sc">~</span><span class="fu">ifelse</span>(.<span class="sc">&gt;</span>.<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">final_05=</span>dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="st">`</span><span class="at">Class 1</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">1</span>,<span class="st">`</span><span class="at">Class 2</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">2</span>, <span class="st">`</span><span class="at">Class 3</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">3</span>,<span class="st">`</span><span class="at">Class 4</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">4</span>, <span class="st">`</span><span class="at">Class 5</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">5</span>))</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>posterior_polca_05_final<span class="ot">&lt;-</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>LCA_best_model_mod<span class="sc">$</span>posterior <span class="sc">%&gt;%</span> </span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_all</span>(<span class="sc">~</span><span class="fu">ifelse</span>(.<span class="sc">&gt;</span>.<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">final_05=</span>dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="st">`</span><span class="at">X1</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">1</span>,<span class="st">`</span><span class="at">X2</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">2</span>, <span class="st">`</span><span class="at">X3</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">3</span>,<span class="st">`</span><span class="at">X4</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">4</span>, <span class="st">`</span><span class="at">X5</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">5</span>))</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>posterior_glca_07_final<span class="ot">&lt;-</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>best_model_glca<span class="sc">$</span>posterior<span class="sc">$</span>ALL <span class="sc">%&gt;%</span> </span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate_all</span>(<span class="sc">~</span><span class="fu">ifelse</span>(.<span class="sc">&gt;</span>.<span class="dv">7</span>,<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">final_07=</span>dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="st">`</span><span class="at">Class 1</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">1</span>,<span class="st">`</span><span class="at">Class 2</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">2</span>, <span class="st">`</span><span class="at">Class 3</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">3</span>,<span class="st">`</span><span class="at">Class 4</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">4</span>, <span class="st">`</span><span class="at">Class 5</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">5</span>))</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>posterior_polca_07_final<span class="ot">&lt;-</span></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>LCA_best_model_mod<span class="sc">$</span>posterior <span class="sc">%&gt;%</span> </span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_all</span>(<span class="sc">~</span><span class="fu">ifelse</span>(.<span class="sc">&gt;</span>.<span class="dv">7</span>,<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">final_07=</span>dplyr<span class="sc">::</span><span class="fu">case_when</span>(<span class="st">`</span><span class="at">X1</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">1</span>,<span class="st">`</span><span class="at">X2</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">2</span>, <span class="st">`</span><span class="at">X3</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">3</span>,<span class="st">`</span><span class="at">X4</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">4</span>, <span class="st">`</span><span class="at">X5</span><span class="st">`</span><span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">5</span>))</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a><span class="co">#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_</span></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>bd_mydata_preds3_posterior<span class="ot">&lt;-</span></span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(mydata_preds3,<span class="at">final_07=</span>posterior_glca_07_final<span class="sc">$</span>final_07,<span class="at">final_05=</span>posterior_glca_05_final<span class="sc">$</span>final_05)<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">outcome=</span><span class="fu">ifelse</span>(outcome<span class="sc">==</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">final_07=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(final_07<span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">3</span>, final_07<span class="sc">==</span><span class="dv">3</span><span class="sc">~</span><span class="dv">1</span>, final_07<span class="sc">==</span><span class="dv">2</span><span class="sc">~</span><span class="dv">4</span>, final_07<span class="sc">==</span><span class="dv">4</span><span class="sc">~</span><span class="dv">2</span>, final_07<span class="sc">==</span><span class="dv">4</span><span class="sc">~</span><span class="dv">1</span>, final_07<span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">4</span>, T<span class="sc">~</span>final_07)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">final_05=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(final_05<span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">3</span>, final_05<span class="sc">==</span><span class="dv">3</span><span class="sc">~</span><span class="dv">1</span>, final_05<span class="sc">==</span><span class="dv">2</span><span class="sc">~</span><span class="dv">4</span>, final_05<span class="sc">==</span><span class="dv">4</span><span class="sc">~</span><span class="dv">2</span>, final_05<span class="sc">==</span><span class="dv">4</span><span class="sc">~</span><span class="dv">1</span>, final_05<span class="sc">==</span><span class="dv">1</span><span class="sc">~</span><span class="dv">4</span>, T<span class="sc">~</span>final_05)) <span class="co">#%&gt;%</span></span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a> <span class="co"># dplyr::mutate(final_07=car::recode(final_07,"2=1;1=2")) %&gt;% </span></span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a><span class="co">#  dplyr::mutate(final_05=car::recode(final_05,"2=1;1=2")) </span></span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a><span class="co">#janitor::tabyl(final_07) </span></span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a>bd_mydata_preds3_posterior_polca<span class="ot">&lt;-</span></span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind.data.frame</span>(mydata_preds3,<span class="at">final_07=</span>posterior_polca_07_final<span class="sc">$</span>final_07,<span class="at">final_05=</span>posterior_polca_05_final<span class="sc">$</span>final_05)<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">outcome=</span><span class="fu">ifelse</span>(outcome<span class="sc">==</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)) <span class="co">#%&gt;% </span></span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dplyr::mutate(final_07=car::recode(final_07,"2=1;1=2")) %&gt;% </span></span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dplyr::mutate(final_05=car::recode(final_05,"2=1;1=2"))</span></span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>bd_reg2<span class="ot">&lt;-</span></span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(outcome<span class="sc">~</span> <span class="fu">relevel</span>(<span class="fu">factor</span>(final_07),<span class="at">ref=</span><span class="dv">2</span>), <span class="at">data=</span> bd_mydata_preds3_posterior)<span class="sc">%&gt;%</span> </span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a>    lmtest<span class="sc">::</span><span class="fu">coeftest</span>(<span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHC, <span class="at">type =</span> <span class="st">"HC0"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a>            broom<span class="sc">::</span><span class="fu">tidy</span>(<span class="at">exponentiate=</span>T, <span class="at">conf.int =</span> T),</span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(outcome<span class="sc">~</span> <span class="fu">relevel</span>(<span class="fu">factor</span>(final_05),<span class="at">ref=</span><span class="dv">2</span>), <span class="at">data=</span> bd_mydata_preds3_posterior)<span class="sc">%&gt;%</span> </span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true" tabindex="-1"></a>    lmtest<span class="sc">::</span><span class="fu">coeftest</span>(<span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHC, <span class="at">type =</span> <span class="st">"HC0"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-50"><a href="#cb48-50" aria-hidden="true" tabindex="-1"></a>            broom<span class="sc">::</span><span class="fu">tidy</span>(<span class="at">exponentiate=</span>T, <span class="at">conf.int =</span> T),</span>
<span id="cb48-51"><a href="#cb48-51" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(outcome<span class="sc">~</span> <span class="fu">relevel</span>(<span class="fu">factor</span>(final_07),<span class="at">ref=</span><span class="dv">2</span>), <span class="at">data=</span> bd_mydata_preds3_posterior_polca)<span class="sc">%&gt;%</span> </span>
<span id="cb48-52"><a href="#cb48-52" aria-hidden="true" tabindex="-1"></a>    lmtest<span class="sc">::</span><span class="fu">coeftest</span>(<span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHC, <span class="at">type =</span> <span class="st">"HC0"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-53"><a href="#cb48-53" aria-hidden="true" tabindex="-1"></a>            broom<span class="sc">::</span><span class="fu">tidy</span>(<span class="at">exponentiate=</span>T, <span class="at">conf.int =</span> T),</span>
<span id="cb48-54"><a href="#cb48-54" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(outcome<span class="sc">~</span> <span class="fu">relevel</span>(<span class="fu">factor</span>(final_05),<span class="at">ref=</span><span class="dv">2</span>), <span class="at">data=</span> bd_mydata_preds3_posterior_polca)<span class="sc">%&gt;%</span> </span>
<span id="cb48-55"><a href="#cb48-55" aria-hidden="true" tabindex="-1"></a>    lmtest<span class="sc">::</span><span class="fu">coeftest</span>(<span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHC, <span class="at">type =</span> <span class="st">"HC0"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-56"><a href="#cb48-56" aria-hidden="true" tabindex="-1"></a>            broom<span class="sc">::</span><span class="fu">tidy</span>(<span class="at">exponentiate=</span>T, <span class="at">conf.int =</span> T)</span>
<span id="cb48-57"><a href="#cb48-57" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-58"><a href="#cb48-58" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>std.error, <span class="sc">-</span>statistic) <span class="sc">%&gt;%</span> </span>
<span id="cb48-59"><a href="#cb48-59" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"estimate"</span>,<span class="st">"conf.low"</span>,<span class="st">"conf.high"</span>),<span class="sc">~</span><span class="fu">round</span>(.,<span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-60"><a href="#cb48-60" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"p.value"</span>),<span class="sc">~</span><span class="fu">round</span>(.,<span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-61"><a href="#cb48-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">mod=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"glca"</span>,<span class="dv">10</span>),<span class="fu">rep</span>(<span class="st">"polca"</span>,<span class="dv">10</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb48-62"><a href="#cb48-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">reg=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"&gt;.7 probs"</span>,<span class="dv">5</span>),<span class="fu">rep</span>(<span class="st">"&gt;.5 probs"</span>,<span class="dv">5</span>),<span class="fu">rep</span>(<span class="st">"&gt;.7 probs"</span>,<span class="dv">5</span>),<span class="fu">rep</span>(<span class="st">"&gt;.5 probs"</span>,<span class="dv">5</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb48-63"><a href="#cb48-63" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(mod, reg, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb48-64"><a href="#cb48-64" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">output=</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'{sprintf("%.2f",exp(estimate))} ({sprintf("%.2f",exp(conf.low))}; {sprintf("%.2f",exp(conf.high))})'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-65"><a href="#cb48-65" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">p.value=</span> <span class="fu">ifelse</span>(p.value<span class="sc">&lt;</span><span class="fl">0.001</span>,<span class="st">"&lt;0.001"</span>,<span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, p.value))) <span class="sc">%&gt;%</span> </span>
<span id="cb48-66"><a href="#cb48-66" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(mod, reg, term, output, p.value) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `exponentiate` argument is not supported in the `tidy()` method for `coeftest` objects and will be ignored.
The `exponentiate` argument is not supported in the `tidy()` method for `coeftest` objects and will be ignored.
The `exponentiate` argument is not supported in the `tidy()` method for `coeftest` objects and will be ignored.
The `exponentiate` argument is not supported in the `tidy()` method for `coeftest` objects and will be ignored.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#cbind.data.frame(mydata_preds3,final_07=posterior_polca_07adj$final_07,final_05=posterior_polca_05adj$final_05) %&gt;% janitor::tabyl(outcome,final_07)</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>bd_reg2 <span class="sc">%&gt;%</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="st">"markdown"</span>,<span class="at">size=</span><span class="dv">9</span>, <span class="at">caption=</span><span class="st">"Regresión logística (x= Clase latente; y= interrumpir)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Regresión logística (x= Clase latente; y= interrumpir)</caption>
<colgroup>
<col style="width: 7%">
<col style="width: 12%">
<col style="width: 46%">
<col style="width: 23%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">mod</th>
<th style="text-align: left;">reg</th>
<th style="text-align: left;">term</th>
<th style="text-align: left;">output</th>
<th style="text-align: left;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">glca</td>
<td style="text-align: left;">&gt;.7 probs</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: left;">2.56 (2.46; 2.66)</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">glca</td>
<td style="text-align: left;">&gt;.7 probs</td>
<td style="text-align: left;">relevel(factor(final_07), ref = 2)1</td>
<td style="text-align: left;">1.00 (0.95; 1.04)</td>
<td style="text-align: left;">0.836</td>
</tr>
<tr class="odd">
<td style="text-align: left;">glca</td>
<td style="text-align: left;">&gt;.7 probs</td>
<td style="text-align: left;">relevel(factor(final_07), ref = 2)3</td>
<td style="text-align: left;">0.91 (0.87; 0.96)</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">glca</td>
<td style="text-align: left;">&gt;.7 probs</td>
<td style="text-align: left;">relevel(factor(final_07), ref = 2)4</td>
<td style="text-align: left;">0.86 (0.83; 0.90)</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">glca</td>
<td style="text-align: left;">&gt;.7 probs</td>
<td style="text-align: left;">relevel(factor(final_07), ref = 2)5</td>
<td style="text-align: left;">0.98 (0.94; 1.02)</td>
<td style="text-align: left;">0.363</td>
</tr>
<tr class="even">
<td style="text-align: left;">glca</td>
<td style="text-align: left;">&gt;.5 probs</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: left;">2.56 (2.46; 2.66)</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">glca</td>
<td style="text-align: left;">&gt;.5 probs</td>
<td style="text-align: left;">relevel(factor(final_05), ref = 2)1</td>
<td style="text-align: left;">0.99 (0.94; 1.03)</td>
<td style="text-align: left;">0.606</td>
</tr>
<tr class="even">
<td style="text-align: left;">glca</td>
<td style="text-align: left;">&gt;.5 probs</td>
<td style="text-align: left;">relevel(factor(final_05), ref = 2)3</td>
<td style="text-align: left;">0.91 (0.87; 0.96)</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">glca</td>
<td style="text-align: left;">&gt;.5 probs</td>
<td style="text-align: left;">relevel(factor(final_05), ref = 2)4</td>
<td style="text-align: left;">0.86 (0.83; 0.90)</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">glca</td>
<td style="text-align: left;">&gt;.5 probs</td>
<td style="text-align: left;">relevel(factor(final_05), ref = 2)5</td>
<td style="text-align: left;">0.98 (0.94; 1.02)</td>
<td style="text-align: left;">0.363</td>
</tr>
<tr class="odd">
<td style="text-align: left;">polca</td>
<td style="text-align: left;">&gt;.7 probs</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: left;">2.53 (2.48; 2.61)</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">polca</td>
<td style="text-align: left;">&gt;.7 probs</td>
<td style="text-align: left;">relevel(factor(final_07), ref = 2)1</td>
<td style="text-align: left;">1.00 (0.96; 1.05)</td>
<td style="text-align: left;">0.836</td>
</tr>
<tr class="odd">
<td style="text-align: left;">polca</td>
<td style="text-align: left;">&gt;.7 probs</td>
<td style="text-align: left;">relevel(factor(final_07), ref = 2)3</td>
<td style="text-align: left;">0.91 (0.88; 0.95)</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">polca</td>
<td style="text-align: left;">&gt;.7 probs</td>
<td style="text-align: left;">relevel(factor(final_07), ref = 2)4</td>
<td style="text-align: left;">0.87 (0.84; 0.90)</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">polca</td>
<td style="text-align: left;">&gt;.7 probs</td>
<td style="text-align: left;">relevel(factor(final_07), ref = 2)5</td>
<td style="text-align: left;">0.98 (0.95; 1.02)</td>
<td style="text-align: left;">0.366</td>
</tr>
<tr class="even">
<td style="text-align: left;">polca</td>
<td style="text-align: left;">&gt;.5 probs</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: left;">2.53 (2.46; 2.59)</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">polca</td>
<td style="text-align: left;">&gt;.5 probs</td>
<td style="text-align: left;">relevel(factor(final_05), ref = 2)1</td>
<td style="text-align: left;">1.01 (0.97; 1.06)</td>
<td style="text-align: left;">0.606</td>
</tr>
<tr class="even">
<td style="text-align: left;">polca</td>
<td style="text-align: left;">&gt;.5 probs</td>
<td style="text-align: left;">relevel(factor(final_05), ref = 2)3</td>
<td style="text-align: left;">0.92 (0.89; 0.96)</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">polca</td>
<td style="text-align: left;">&gt;.5 probs</td>
<td style="text-align: left;">relevel(factor(final_05), ref = 2)4</td>
<td style="text-align: left;">0.87 (0.85; 0.90)</td>
<td style="text-align: left;">&lt;0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">polca</td>
<td style="text-align: left;">&gt;.5 probs</td>
<td style="text-align: left;">relevel(factor(final_05), ref = 2)5</td>
<td style="text-align: left;">0.99 (0.96; 1.02)</td>
<td style="text-align: left;">0.615</td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>bd_reg2 <span class="sc">%&gt;%</span> rio<span class="sc">::</span><span class="fu">export</span>(<span class="st">"tab_reg.xlsx"</span>, <span class="at">overwrite=</span>T)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># knitr::kable("html",size=9, caption="Regresión logística (x= Clase latente; y= interrumpir)") %&gt;% kableExtra::kable_classic()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>reg_log<span class="ot">&lt;-</span><span class="fu">glm</span>(outcome<span class="sc">~</span> final_07, <span class="at">data=</span> bd_mydata_preds3_posterior <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">final_07=</span><span class="fu">factor</span>(final_07)))</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>reg_log<span class="ot">&lt;-</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(outcome<span class="sc">~</span> <span class="fu">relevel</span>(<span class="fu">factor</span>(final_05),<span class="at">ref=</span><span class="dv">2</span>), <span class="at">data=</span> bd_mydata_preds3_posterior_polca)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>ggeffects<span class="sc">::</span><span class="fu">ggpredict</span>(reg_log)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$final_05
# Predicted values of outcome

final_05 | Predicted |       95% CI
-----------------------------------
       1 |      0.94 | [0.88, 0.99]
       2 |      0.93 | [0.89, 0.96]
       3 |      0.85 | [0.82, 0.88]
       4 |      0.79 | [0.78, 0.81]
       5 |      0.92 | [0.89, 0.95]

attr(,"class")
[1] "ggalleffects" "list"        
attr(,"model.name")
[1] "reg_log"</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>model3ff_reg_rec <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(<span class="fu">glm</span>(outcome<span class="sc">~</span> <span class="fu">factor</span>(final_05), <span class="at">data=</span> bd_mydata_preds3_posterior_polca), <span class="st">"final_05"</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(model3ff_reg_rec, <span class="at">type =</span> <span class="st">"response"</span>)<span class="co">#, type = "lp")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> contrast              estimate     SE   df t.ratio p.value
 final_051 - final_052  0.01171 0.0333 3782   0.352  0.9967
 final_051 - final_053  0.08928 0.0328 3782   2.723  0.0508
 final_051 - final_054  0.14682 0.0296 3782   4.960  &lt;.0001
 final_051 - final_055  0.02020 0.0323 3782   0.625  0.9711
 final_052 - final_053  0.07757 0.0235 3782   3.295  0.0088
 final_052 - final_054  0.13510 0.0189 3782   7.166  &lt;.0001
 final_052 - final_055  0.00849 0.0229 3782   0.371  0.9960
 final_053 - final_054  0.05753 0.0180 3782   3.200  0.0121
 final_053 - final_055 -0.06908 0.0221 3782  -3.119  0.0157
 final_054 - final_055 -0.12662 0.0171 3782  -7.413  &lt;.0001

P value adjustment: tukey method for comparing a family of 5 estimates </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>mydata_preds3 <span class="sc">%&gt;%</span> </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(CAUSAL, PREV_TRAMO_REC, HITO2_DECISION_MUJER_IVE) <span class="sc">%&gt;%</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(CAUSAL, PREV_TRAMO_REC) <span class="sc">%&gt;%</span> </span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">ive=</span><span class="fu">sum</span>(n[HITO2_DECISION_MUJER_IVE<span class="sc">==</span><span class="st">"INTERRUMPIR EL EMBARAZO"</span>]), <span class="at">perc=</span> scales<span class="sc">::</span><span class="fu">percent</span>(ive<span class="sc">/</span><span class="fu">sum</span>(n))) <span class="sc">%&gt;%</span> </span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">CAUSAL=</span> <span class="fu">case_when</span>(CAUSAL<span class="sc">==</span><span class="dv">2</span><span class="sc">~</span> <span class="st">"Causal 1"</span>, CAUSAL<span class="sc">==</span><span class="dv">3</span><span class="sc">~</span> <span class="st">"Causal 2"</span>, CAUSAL<span class="sc">==</span><span class="dv">4</span><span class="sc">~</span> <span class="st">"Causal 3"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">PREV_TRAMO_REC=</span> <span class="fu">case_when</span>(PREV_TRAMO_REC<span class="sc">==</span><span class="dv">1</span><span class="sc">~</span> <span class="st">"NA"</span>, PREV_TRAMO_REC<span class="sc">==</span><span class="dv">2</span><span class="sc">~</span> <span class="st">"ISAPRE o FFAA"</span>, PREV_TRAMO_REC<span class="sc">==</span><span class="dv">3</span><span class="sc">~</span> <span class="st">"FONASA A/B"</span>, PREV_TRAMO_REC<span class="sc">==</span><span class="dv">4</span><span class="sc">~</span> <span class="st">"FONASA C/D"</span>, PREV_TRAMO_REC<span class="sc">==</span><span class="dv">5</span><span class="sc">~</span> <span class="st">"NINGUNA"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(CAUSAL) <span class="sc">%&gt;%</span> </span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">perc_causal=</span>scales<span class="sc">::</span><span class="fu">percent</span>(ive<span class="sc">/</span><span class="fu">sum</span>(ive))) <span class="sc">%&gt;%</span> </span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(CAUSAL, PREV_TRAMO_REC, perc_causal, perc, ive) <span class="sc">%&gt;%</span> </span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="st">"markdown"</span>, <span class="at">caption=</span><span class="st">"Distribución causal, previsión e IVE"</span>, <span class="at">col.names=</span><span class="fu">c</span>(<span class="st">"Causal"</span>,<span class="st">"Previsión y Tramo"</span>, <span class="st">"% de la previsión en la causal"</span>, <span class="st">"% de IVE para cada previsión por causal"</span>, <span class="st">"n"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'CAUSAL', 'PREV_TRAMO_REC'. You can
override using the `.groups` argument.
`summarise()` has grouped output by 'CAUSAL'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Distribución causal, previsión e IVE</caption>
<colgroup>
<col style="width: 8%">
<col style="width: 17%">
<col style="width: 30%">
<col style="width: 39%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Causal</th>
<th style="text-align: left;">Previsión y Tramo</th>
<th style="text-align: left;">% de la previsión en la causal</th>
<th style="text-align: left;">% de IVE para cada previsión por causal</th>
<th style="text-align: right;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Causal 1</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">0.3%</td>
<td style="text-align: left;">100%</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Causal 1</td>
<td style="text-align: left;">ISAPRE o FFAA</td>
<td style="text-align: left;">9.3%</td>
<td style="text-align: left;">91%</td>
<td style="text-align: right;">90</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Causal 1</td>
<td style="text-align: left;">FONASA A/B</td>
<td style="text-align: left;">55.3%</td>
<td style="text-align: left;">80%</td>
<td style="text-align: right;">535</td>
</tr>
<tr class="even">
<td style="text-align: left;">Causal 1</td>
<td style="text-align: left;">FONASA C/D</td>
<td style="text-align: left;">31.9%</td>
<td style="text-align: left;">84%</td>
<td style="text-align: right;">309</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Causal 1</td>
<td style="text-align: left;">NINGUNA</td>
<td style="text-align: left;">3.2%</td>
<td style="text-align: left;">97%</td>
<td style="text-align: right;">31</td>
</tr>
<tr class="even">
<td style="text-align: left;">Causal 2</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">0.1%</td>
<td style="text-align: left;">33%</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Causal 2</td>
<td style="text-align: left;">ISAPRE o FFAA</td>
<td style="text-align: left;">20.8%</td>
<td style="text-align: left;">92%</td>
<td style="text-align: right;">321</td>
</tr>
<tr class="even">
<td style="text-align: left;">Causal 2</td>
<td style="text-align: left;">FONASA A/B</td>
<td style="text-align: left;">47.4%</td>
<td style="text-align: left;">78%</td>
<td style="text-align: right;">731</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Causal 2</td>
<td style="text-align: left;">FONASA C/D</td>
<td style="text-align: left;">30.4%</td>
<td style="text-align: left;">81%</td>
<td style="text-align: right;">469</td>
</tr>
<tr class="even">
<td style="text-align: left;">Causal 2</td>
<td style="text-align: left;">NINGUNA</td>
<td style="text-align: left;">1.2%</td>
<td style="text-align: left;">90%</td>
<td style="text-align: right;">18</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Causal 3</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">0.74%</td>
<td style="text-align: left;">100%</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Causal 3</td>
<td style="text-align: left;">ISAPRE o FFAA</td>
<td style="text-align: left;">5.93%</td>
<td style="text-align: left;">98%</td>
<td style="text-align: right;">40</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Causal 3</td>
<td style="text-align: left;">FONASA A/B</td>
<td style="text-align: left;">66.47%</td>
<td style="text-align: left;">90%</td>
<td style="text-align: right;">448</td>
</tr>
<tr class="even">
<td style="text-align: left;">Causal 3</td>
<td style="text-align: left;">FONASA C/D</td>
<td style="text-align: left;">20.03%</td>
<td style="text-align: left;">96%</td>
<td style="text-align: right;">135</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Causal 3</td>
<td style="text-align: left;">NINGUNA</td>
<td style="text-align: left;">6.82%</td>
<td style="text-align: left;">98%</td>
<td style="text-align: right;">46</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#https://github.com/cran/effects/blob/master/R/effectspoLCA.R</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co">#https://martinpaladino.xyz/2018/11/27/an%C3%A1lisis-de-clases-latentes-ii/</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="co">#The effects-plots (or also the numeric output) give you the predicted values of the outcome for certain given values for the predictors (independent variables). It just "inserts" the value of a predictor into the model formula. Since you calculate the effect for one predictor at time, the other predictors are "hold constant", i.e. their regression coefficients are not ignored, but - by default - their mean value is chosen.</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stats.stackexchange.com/questions/362414/interpretation-of-regression-coefficients-in-latent-class-regression-using-polc?rq=1</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="co">#https://stats.stackexchange.com/questions/362414/interpretation-of-regression-coefficients-in-latent-class-regression-using-polc</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graph of poLCA object</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>poLCA.means <span class="ot">&lt;-</span> <span class="cf">function</span>(fit,ORDERING) {</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    t <span class="ot">&lt;-</span> <span class="fu">table</span>(fit<span class="sc">$</span>predclass)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">length</span>(fit<span class="sc">$</span>P) ; N <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    Class <span class="ot">&lt;-</span> <span class="fu">character</span>()</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    NLevels <span class="ot">&lt;-</span> <span class="fu">dim</span>(p<span class="sc">$</span>y)[<span class="dv">2</span>]</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span> <span class="sc">:</span> n) {</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>        Class[i] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">'Class '</span>,i,<span class="st">' (n='</span>,t[i],<span class="st">')'</span>,<span class="at">sep=</span><span class="st">''</span>)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>    CL <span class="ot">&lt;-</span> <span class="fu">tibble</span>(N,Class)</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>    fit.t <span class="ot">&lt;-</span> <span class="fu">tidy</span>(fit) <span class="sc">%&gt;%</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>           <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">factor</span>(variable,<span class="at">levels=</span>ORDERING[<span class="dv">1</span><span class="sc">:</span>NLevels])) <span class="sc">%&gt;%</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">inner_join</span>(CL,<span class="at">by=</span><span class="fu">c</span>(<span class="st">'class'</span> <span class="ot">=</span> <span class="st">'N'</span>))</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span>   <span class="fu">ggplot</span>(fit.t,<span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> estimate, <span class="at">fill =</span> outcome)) <span class="sc">+</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"stack"</span>,<span class="at">colour=</span><span class="st">'darkgrey'</span>) <span class="sc">+</span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>       <span class="fu">facet_wrap</span>(<span class="sc">~</span> Class)</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(g)</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>poLCA.means <span class="ot">&lt;-</span> <span class="cf">function</span>(fit,ORDERING) {</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>    t <span class="ot">&lt;-</span> <span class="fu">table</span>(fit<span class="sc">$</span>predclass)</span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">length</span>(fit<span class="sc">$</span>P) ; N <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>    Class <span class="ot">&lt;-</span> <span class="fu">character</span>()</span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>    NLevels <span class="ot">&lt;-</span> <span class="fu">dim</span>(p<span class="sc">$</span>y)[<span class="dv">2</span>]</span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span> <span class="sc">:</span> n) {</span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>        Class[i] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">'Class '</span>,i,<span class="st">' (n='</span>,t[i],<span class="st">')'</span>,<span class="at">sep=</span><span class="st">''</span>)</span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a>    CL <span class="ot">&lt;-</span> <span class="fu">tibble</span>(N,Class)</span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a>    fit.t <span class="ot">&lt;-</span> <span class="fu">tidy</span>(fit) <span class="sc">%&gt;%</span></span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">variable =</span> </span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">factor</span>(variable,</span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a>                          <span class="at">levels=</span>ORDERING[<span class="dv">1</span><span class="sc">:</span>NLevels])) <span class="sc">%&gt;%</span></span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a>        <span class="fu">inner_join</span>(CL,<span class="at">by=</span><span class="fu">c</span>(<span class="st">'class'</span> <span class="ot">=</span> <span class="st">'N'</span>))</span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a>    g <span class="ot">&lt;-</span>   <span class="fu">ggplot</span>(fit.t <span class="sc">%&gt;%</span> <span class="fu">filter</span>(outcome <span class="sc">==</span> <span class="dv">2</span>),</span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> estimate,</span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a>                      <span class="at">group =</span> outcome,<span class="at">colour=</span>Class)) <span class="sc">+</span></span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb59-45"><a href="#cb59-45" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb59-46"><a href="#cb59-46" aria-hidden="true" tabindex="-1"></a>        <span class="co">#geom_bar(stat = "identity", position = "stack",colour='darkgrey') +</span></span>
<span id="cb59-47"><a href="#cb59-47" aria-hidden="true" tabindex="-1"></a>        <span class="fu">facet_wrap</span>(<span class="sc">~</span> Class)</span>
<span id="cb59-48"><a href="#cb59-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(g)</span>
<span id="cb59-49"><a href="#cb59-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-50"><a href="#cb59-50" aria-hidden="true" tabindex="-1"></a>poLCA.table <span class="ot">&lt;-</span> <span class="cf">function</span>(fit,ORDERING) {</span>
<span id="cb59-51"><a href="#cb59-51" aria-hidden="true" tabindex="-1"></a>    t <span class="ot">&lt;-</span> <span class="fu">table</span>(fit<span class="sc">$</span>predclass)</span>
<span id="cb59-52"><a href="#cb59-52" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">length</span>(fit<span class="sc">$</span>P) ; N <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb59-53"><a href="#cb59-53" aria-hidden="true" tabindex="-1"></a>    Class <span class="ot">&lt;-</span> <span class="fu">character</span>()</span>
<span id="cb59-54"><a href="#cb59-54" aria-hidden="true" tabindex="-1"></a>    NLevels <span class="ot">&lt;-</span> <span class="fu">dim</span>(p<span class="sc">$</span>y)[<span class="dv">2</span>]</span>
<span id="cb59-55"><a href="#cb59-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-56"><a href="#cb59-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span> <span class="sc">:</span> n) {</span>
<span id="cb59-57"><a href="#cb59-57" aria-hidden="true" tabindex="-1"></a>        Class[i] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">'Class '</span>,i,<span class="st">' (n='</span>,t[i],<span class="st">')'</span>,<span class="at">sep=</span><span class="st">''</span>)</span>
<span id="cb59-58"><a href="#cb59-58" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb59-59"><a href="#cb59-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-60"><a href="#cb59-60" aria-hidden="true" tabindex="-1"></a>    CL <span class="ot">&lt;-</span> <span class="fu">tibble</span>(N,Class)</span>
<span id="cb59-61"><a href="#cb59-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-62"><a href="#cb59-62" aria-hidden="true" tabindex="-1"></a>    fit.t <span class="ot">&lt;-</span> <span class="fu">tidy</span>(fit) <span class="sc">%&gt;%</span></span>
<span id="cb59-63"><a href="#cb59-63" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">factor</span>(variable,<span class="at">levels=</span>ORDERING[<span class="dv">1</span><span class="sc">:</span>NLevels])) <span class="sc">%&gt;%</span></span>
<span id="cb59-64"><a href="#cb59-64" aria-hidden="true" tabindex="-1"></a>        <span class="fu">inner_join</span>(CL,<span class="at">by=</span><span class="fu">c</span>(<span class="st">'class'</span> <span class="ot">=</span> <span class="st">'N'</span>))</span>
<span id="cb59-65"><a href="#cb59-65" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-66"><a href="#cb59-66" aria-hidden="true" tabindex="-1"></a>    g <span class="ot">&lt;-</span>   <span class="fu">ggplot</span>(fit.t,<span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> estimate, <span class="at">fill =</span> outcome)) <span class="sc">+</span></span>
<span id="cb59-67"><a href="#cb59-67" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"stack"</span>,<span class="at">colour=</span><span class="st">'darkgrey'</span>) <span class="sc">+</span></span>
<span id="cb59-68"><a href="#cb59-68" aria-hidden="true" tabindex="-1"></a>        <span class="fu">facet_wrap</span>(<span class="sc">~</span> Class)</span>
<span id="cb59-69"><a href="#cb59-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(fit.t)</span>
<span id="cb59-70"><a href="#cb59-70" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-71"><a href="#cb59-71" aria-hidden="true" tabindex="-1"></a>ReturnCoeffLCA <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb59-72"><a href="#cb59-72" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">length</span>(x<span class="sc">$</span>P)</span>
<span id="cb59-73"><a href="#cb59-73" aria-hidden="true" tabindex="-1"></a>length <span class="ot">&lt;-</span> <span class="fu">length</span>(x<span class="sc">$</span>coeff)</span>
<span id="cb59-74"><a href="#cb59-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-75"><a href="#cb59-75" aria-hidden="true" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> <span class="fu">dim</span>(x<span class="sc">$</span>coeff)</span>
<span id="cb59-76"><a href="#cb59-76" aria-hidden="true" tabindex="-1"></a>    height <span class="ot">&lt;-</span> dimensions[<span class="dv">1</span>]</span>
<span id="cb59-77"><a href="#cb59-77" aria-hidden="true" tabindex="-1"></a>    width <span class="ot">&lt;-</span> dimensions[<span class="dv">2</span>]</span>
<span id="cb59-78"><a href="#cb59-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-79"><a href="#cb59-79" aria-hidden="true" tabindex="-1"></a>names <span class="ot">&lt;-</span> <span class="fu">dimnames</span>(x<span class="sc">$</span>coeff)[[<span class="dv">1</span>]]</span>
<span id="cb59-80"><a href="#cb59-80" aria-hidden="true" tabindex="-1"></a>    names <span class="ot">&lt;-</span> <span class="fu">rep</span>(names,width)</span>
<span id="cb59-81"><a href="#cb59-81" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-82"><a href="#cb59-82" aria-hidden="true" tabindex="-1"></a>form <span class="ot">&lt;-</span> <span class="fu">as.character</span>(x<span class="sc">$</span>call<span class="sc">$</span>formula)</span>
<span id="cb59-83"><a href="#cb59-83" aria-hidden="true" tabindex="-1"></a>    form <span class="ot">&lt;-</span> <span class="fu">rep</span>(form, length)</span>
<span id="cb59-84"><a href="#cb59-84" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-85"><a href="#cb59-85" aria-hidden="true" tabindex="-1"></a>Coeff <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(x<span class="sc">$</span>coeff) <span class="co"># L elements</span></span>
<span id="cb59-86"><a href="#cb59-86" aria-hidden="true" tabindex="-1"></a>Coeff.se <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(x<span class="sc">$</span>coeff.se) <span class="co"># L elements</span></span>
<span id="cb59-87"><a href="#cb59-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-88"><a href="#cb59-88" aria-hidden="true" tabindex="-1"></a>tval <span class="ot">&lt;-</span> Coeff<span class="sc">/</span>Coeff.se</span>
<span id="cb59-89"><a href="#cb59-89" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="dv">3</span><span class="sc">*</span><span class="fu">abs</span>(<span class="fu">pt</span>(tval,x<span class="sc">$</span>resid.df)<span class="sc">-</span><span class="fl">0.5</span>)</span>
<span id="cb59-90"><a href="#cb59-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-91"><a href="#cb59-91" aria-hidden="true" tabindex="-1"></a>comp <span class="ot">=</span> <span class="fu">vector</span>()</span>
<span id="cb59-92"><a href="#cb59-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-93"><a href="#cb59-93" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (w <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>width) {</span>
<span id="cb59-94"><a href="#cb59-94" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (h <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>height) {</span>
<span id="cb59-95"><a href="#cb59-95" aria-hidden="true" tabindex="-1"></a>    comp <span class="ot">&lt;-</span> <span class="fu">c</span>(comp, <span class="fu">paste0</span>(w<span class="sc">+</span><span class="dv">1</span>,<span class="st">'/1'</span>))</span>
<span id="cb59-96"><a href="#cb59-96" aria-hidden="true" tabindex="-1"></a>    <span class="co">#cat(comp)</span></span>
<span id="cb59-97"><a href="#cb59-97" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb59-98"><a href="#cb59-98" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb59-99"><a href="#cb59-99" aria-hidden="true" tabindex="-1"></a><span class="co">#comp</span></span>
<span id="cb59-100"><a href="#cb59-100" aria-hidden="true" tabindex="-1"></a>disp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(form,names,comp,Coeff,Coeff.se,tval,pval)</span>
<span id="cb59-101"><a href="#cb59-101" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(disp) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Formula'</span>, <span class="st">'Variables'</span>, <span class="st">'Groups'</span>, <span class="st">'Coeff'</span>, <span class="st">'SE'</span>, <span class="st">'t'</span>, <span class="st">'p-value'</span>)</span>
<span id="cb59-102"><a href="#cb59-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-103"><a href="#cb59-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-104"><a href="#cb59-104" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(disp)</span>
<span id="cb59-105"><a href="#cb59-105" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-106"><a href="#cb59-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-107"><a href="#cb59-107" aria-hidden="true" tabindex="-1"></a><span class="co">#g &lt;- poLCA.means(d,ORDERING) </span></span>
<span id="cb59-108"><a href="#cb59-108" aria-hidden="true" tabindex="-1"></a><span class="co">#g &lt;- g + theme_bw(base_size=12) +</span></span>
<span id="cb59-109"><a href="#cb59-109" aria-hidden="true" tabindex="-1"></a><span class="co">#       theme(axis.text.x = element_text(angle = -90, hjust=0,vjust = 0.5, size=9)) +</span></span>
<span id="cb59-110"><a href="#cb59-110" aria-hidden="true" tabindex="-1"></a><span class="co">#       ggtitle('Class membership probabilities - Base model') + xlab('Symptom, sign, or finding') +</span></span>
<span id="cb59-111"><a href="#cb59-111" aria-hidden="true" tabindex="-1"></a><span class="co">#       #guides(fill=FALSE) +</span></span>
<span id="cb59-112"><a href="#cb59-112" aria-hidden="true" tabindex="-1"></a><span class="co">#       scale_fill_gradientn(colours=terrain.colors(2))</span></span>
<span id="cb59-113"><a href="#cb59-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-114"><a href="#cb59-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-115"><a href="#cb59-115" aria-hidden="true" tabindex="-1"></a><span class="co">#Convert logOdds to probability</span></span>
<span id="cb59-116"><a href="#cb59-116" aria-hidden="true" tabindex="-1"></a>Prob <span class="ot">&lt;-</span> <span class="cf">function</span>(logOdds) {</span>
<span id="cb59-117"><a href="#cb59-117" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>((<span class="fu">exp</span>(logOdds))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span> <span class="fu">exp</span>(logOdds)))</span>
<span id="cb59-118"><a href="#cb59-118" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-119"><a href="#cb59-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-120"><a href="#cb59-120" aria-hidden="true" tabindex="-1"></a>poLCA.coeff.names <span class="ot">&lt;-</span> <span class="cf">function</span>(fit) {</span>
<span id="cb59-121"><a href="#cb59-121" aria-hidden="true" tabindex="-1"></a>    <span class="co"># takes a poLCA fit with coefficients</span></span>
<span id="cb59-122"><a href="#cb59-122" aria-hidden="true" tabindex="-1"></a>    names <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">attributes</span>(fit<span class="sc">$</span>coeff)<span class="sc">$</span>dimnames[<span class="dv">1</span>])</span>
<span id="cb59-123"><a href="#cb59-123" aria-hidden="true" tabindex="-1"></a>    names <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'[:]'</span>,<span class="st">'*'</span>,names)</span>
<span id="cb59-124"><a href="#cb59-124" aria-hidden="true" tabindex="-1"></a>    <span class="co"># returns a character vector of the names of those coefficients</span></span>
<span id="cb59-125"><a href="#cb59-125" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(names)</span>
<span id="cb59-126"><a href="#cb59-126" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-127"><a href="#cb59-127" aria-hidden="true" tabindex="-1"></a><span class="co">#poLCA.coeff.names(poLCA.PCV2.PPV2)</span></span>
<span id="cb59-128"><a href="#cb59-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-129"><a href="#cb59-129" aria-hidden="true" tabindex="-1"></a><span class="co"># Crude CI's for poLCA</span></span>
<span id="cb59-130"><a href="#cb59-130" aria-hidden="true" tabindex="-1"></a>poLCA.CI <span class="ot">&lt;-</span> <span class="cf">function</span>(fit,<span class="at">Z=</span><span class="fl">1.96</span>) {</span>
<span id="cb59-131"><a href="#cb59-131" aria-hidden="true" tabindex="-1"></a>    coef <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(fit<span class="sc">$</span>coeff)  <span class="sc">%&gt;%</span></span>
<span id="cb59-132"><a href="#cb59-132" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">'Term'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-133"><a href="#cb59-133" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">Term =</span> <span class="fu">gsub</span>(<span class="st">'[()]'</span>,<span class="st">''</span>,Term)) <span class="sc">%&gt;%</span></span>
<span id="cb59-134"><a href="#cb59-134" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">Term =</span> <span class="fu">gsub</span>(<span class="st">'[:]'</span>,<span class="st">'.'</span>,Term)) </span>
<span id="cb59-135"><a href="#cb59-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-136"><a href="#cb59-136" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The rest of the columns are called X1, X2 and so on.</span></span>
<span id="cb59-137"><a href="#cb59-137" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We want to change these to Class_2:1 Class_3:1 etc.</span></span>
<span id="cb59-138"><a href="#cb59-138" aria-hidden="true" tabindex="-1"></a>    NN <span class="ot">&lt;-</span> <span class="fu">names</span>(coef)[<span class="sc">-</span><span class="dv">1</span>] <span class="co"># X1, X2, X3, ...</span></span>
<span id="cb59-139"><a href="#cb59-139" aria-hidden="true" tabindex="-1"></a>    NN <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'X'</span>,<span class="st">''</span>,NN) <span class="co"># '1', '2', '3'', ...</span></span>
<span id="cb59-140"><a href="#cb59-140" aria-hidden="true" tabindex="-1"></a>    NN <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(NN) <span class="sc">+</span> <span class="dv">1</span> <span class="co"># 2, 3, 4, ...</span></span>
<span id="cb59-141"><a href="#cb59-141" aria-hidden="true" tabindex="-1"></a>    NN <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">'Class_'</span>,NN,<span class="st">':1'</span>,<span class="at">sep=</span><span class="st">''</span>) <span class="co"># Class_2:1, Class_3:1</span></span>
<span id="cb59-142"><a href="#cb59-142" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(coef) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Term'</span>,NN)</span>
<span id="cb59-143"><a href="#cb59-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-144"><a href="#cb59-144" aria-hidden="true" tabindex="-1"></a>    coef <span class="ot">&lt;-</span> coef <span class="sc">%&gt;%</span></span>
<span id="cb59-145"><a href="#cb59-145" aria-hidden="true" tabindex="-1"></a>        <span class="fu">gather</span>(Class,Value,<span class="sc">-</span>Term)</span>
<span id="cb59-146"><a href="#cb59-146" aria-hidden="true" tabindex="-1"></a>    coef</span>
<span id="cb59-147"><a href="#cb59-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-148"><a href="#cb59-148" aria-hidden="true" tabindex="-1"></a>    se   <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(fit<span class="sc">$</span>coeff.se)  <span class="sc">%&gt;%</span></span>
<span id="cb59-149"><a href="#cb59-149" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">'Term'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-150"><a href="#cb59-150" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">Term =</span> <span class="fu">gsub</span>(<span class="st">'[()]'</span>,<span class="st">''</span>,Term)) <span class="sc">%&gt;%</span></span>
<span id="cb59-151"><a href="#cb59-151" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">Term =</span> <span class="fu">gsub</span>(<span class="st">'[:]'</span>,<span class="st">'.'</span>,Term)) </span>
<span id="cb59-152"><a href="#cb59-152" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(se) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Term'</span>,NN)</span>
<span id="cb59-153"><a href="#cb59-153" aria-hidden="true" tabindex="-1"></a>    se <span class="ot">&lt;-</span> se <span class="sc">%&gt;%</span></span>
<span id="cb59-154"><a href="#cb59-154" aria-hidden="true" tabindex="-1"></a>        <span class="fu">gather</span>(Class,Value,<span class="sc">-</span>Term)</span>
<span id="cb59-155"><a href="#cb59-155" aria-hidden="true" tabindex="-1"></a>    se</span>
<span id="cb59-156"><a href="#cb59-156" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-157"><a href="#cb59-157" aria-hidden="true" tabindex="-1"></a>    coef <span class="ot">&lt;-</span> coef <span class="sc">%&gt;%</span></span>
<span id="cb59-158"><a href="#cb59-158" aria-hidden="true" tabindex="-1"></a>        <span class="fu">inner_join</span>(se, <span class="at">by=</span><span class="fu">c</span>(<span class="st">'Term'</span>,<span class="st">'Class'</span>),</span>
<span id="cb59-159"><a href="#cb59-159" aria-hidden="true" tabindex="-1"></a>                   <span class="at">suffix=</span><span class="fu">c</span>(<span class="st">'.coef'</span>,<span class="st">'.se'</span>))</span>
<span id="cb59-160"><a href="#cb59-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-161"><a href="#cb59-161" aria-hidden="true" tabindex="-1"></a>    coef <span class="ot">&lt;-</span> coef <span class="sc">%&gt;%</span></span>
<span id="cb59-162"><a href="#cb59-162" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">LowerCI =</span> Value.coef<span class="sc">-</span>Z<span class="sc">*</span>Value.se) <span class="sc">%&gt;%</span></span>
<span id="cb59-163"><a href="#cb59-163" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">UpperCI =</span> Value.coef<span class="sc">+</span>Z<span class="sc">*</span>Value.se) <span class="sc">%&gt;%</span></span>
<span id="cb59-164"><a href="#cb59-164" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">OR =</span> <span class="fu">exp</span>(Value.coef)) <span class="sc">%&gt;%</span></span>
<span id="cb59-165"><a href="#cb59-165" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">OR.Lr =</span> <span class="fu">exp</span>(LowerCI)) <span class="sc">%&gt;%</span></span>
<span id="cb59-166"><a href="#cb59-166" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">OR.Upr =</span> <span class="fu">exp</span>(UpperCI)) <span class="sc">%&gt;%</span></span>
<span id="cb59-167"><a href="#cb59-167" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="sc">-</span>LowerCI,<span class="sc">-</span>UpperCI)</span>
<span id="cb59-168"><a href="#cb59-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-169"><a href="#cb59-169" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(coef)</span>
<span id="cb59-170"><a href="#cb59-170" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-171"><a href="#cb59-171" aria-hidden="true" tabindex="-1"></a><span class="co">#d &lt;- poLCA.CI(poLCA.PCV2.PPV2)</span></span>
<span id="cb59-172"><a href="#cb59-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-173"><a href="#cb59-173" aria-hidden="true" tabindex="-1"></a><span class="co">#kable(d)</span></span>
<span id="cb59-174"><a href="#cb59-174" aria-hidden="true" tabindex="-1"></a><span class="co">#poLCA.CI(LCA_best_model_adj_mod)</span></span>
<span id="cb59-175"><a href="#cb59-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-176"><a href="#cb59-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-177"><a href="#cb59-177" aria-hidden="true" tabindex="-1"></a><span class="co"># este es con resultado distal (sensibilidad)</span></span>
<span id="cb59-178"><a href="#cb59-178" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb59-179"><a href="#cb59-179" aria-hidden="true" tabindex="-1"></a><span class="co"># Probabilidad de pertenecer a una clase, según interrupción del embarazo</span></span>
<span id="cb59-180"><a href="#cb59-180" aria-hidden="true" tabindex="-1"></a><span class="co"># Clase No interrumpe           Interrumpe</span></span>
<span id="cb59-181"><a href="#cb59-181" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 0.19(95%CI=0.16,0.23)   0.18(95%CI=0.17,0.19)</span></span>
<span id="cb59-182"><a href="#cb59-182" aria-hidden="true" tabindex="-1"></a><span class="co"># *2    0.18(95%CI=0.15,0.21)   0.15(95%CI=0.14,0.17)* ---&gt; estas son las cuicas, también </span></span>
<span id="cb59-183"><a href="#cb59-183" aria-hidden="true" tabindex="-1"></a><span class="co"># *3    0.3(95%CI=0.26,0.33)    0.39(95%CI=0.37,0.4)*</span></span>
<span id="cb59-184"><a href="#cb59-184" aria-hidden="true" tabindex="-1"></a><span class="co"># 4 0.16(95%CI=0.13,0.19)   0.13(95%CI=0.12,0.14)</span></span>
<span id="cb59-185"><a href="#cb59-185" aria-hidden="true" tabindex="-1"></a><span class="co"># 5 0.17(95%CI=0.15,0.21)   0.15(95%CI=0.14,0.17)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extracting class-conditional probabilities</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>lc<span class="ot">&lt;-</span>LCA_best_model_mod</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">length</span>(lc<span class="sc">$</span>P)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>probs <span class="ot">&lt;-</span> lc<span class="sc">$</span>probs</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> lc<span class="sc">$</span>P</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> lc<span class="sc">$</span>y</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>ti <span class="ot">&lt;-</span> lc<span class="sc">$</span>ti</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">nrow</span>(probs[[<span class="dv">1</span>]])</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>pi.class <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="at">nrow=</span><span class="fu">length</span>(probs),<span class="at">ncol=</span>R)</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(probs)) </span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>        pi.class[j,] <span class="ot">&lt;-</span> probs[[j]][,<span class="dv">2</span>]</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(pi.class) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">names</span>(y),<span class="fu">round</span>(P,<span class="dv">3</span>))</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="co">#rownames(pi.class) &lt;- row.names</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>probs.se <span class="ot">&lt;-</span> lc<span class="sc">$</span>probs.se</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>se.class <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="at">nrow=</span><span class="fu">length</span>(probs.se),<span class="at">ncol=</span>R)</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(probs.se)) </span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>        se.class[j,] <span class="ot">&lt;-</span> probs.se[[j]][,<span class="dv">2</span>]</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(se.class) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">names</span>(y),<span class="fu">round</span>(P,<span class="dv">3</span>))</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a><span class="co">#rownames(se.class) &lt;- row.names</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>ds.plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Classes=</span><span class="fu">as.vector</span>(<span class="fu">col</span>(pi.class)),<span class="at">Manifest.variables=</span><span class="fu">as.vector</span>(<span class="fu">row</span>(pi.class)),<span class="at">value=</span><span class="fu">as.vector</span>(pi.class))</span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>ds.plot.stata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Classes=</span><span class="fu">as.vector</span>(<span class="fu">col</span>(pi.class)),<span class="at">Manifest.variables=</span><span class="fu">as.vector</span>(<span class="fu">row</span>(pi.class)), <span class="at">value=</span><span class="fu">as.vector</span>(pi.class),<span class="at">names=</span><span class="fu">rownames</span>(pi.class), <span class="at">se=</span><span class="fu">as.vector</span>(se.class))</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>ds.plot.stata <span class="sc">%&gt;%</span> tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from=</span>Classes, <span class="at">values_from=</span><span class="fu">c</span>(<span class="st">"value"</span>,<span class="st">"se"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate_if</span>(is.numeric, <span class="sc">~</span><span class="fu">round</span>(.,<span class="dv">3</span>))</span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a>ds.plot.stata <span class="sc">%&gt;%</span> tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from=</span>Classes, <span class="at">values_from=</span><span class="fu">c</span>(<span class="st">"value"</span>,<span class="st">"se"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate_if</span>(is.numeric, <span class="sc">~</span><span class="fu">round</span>(.,<span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">c1=</span> <span class="fu">paste0</span>(value_1<span class="sc">*</span><span class="dv">100</span>,<span class="st">" ("</span>,se_1<span class="sc">*</span><span class="dv">100</span>,<span class="st">")"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">c2=</span> <span class="fu">paste0</span>(value_2<span class="sc">*</span><span class="dv">100</span>,<span class="st">" ("</span>,se_2<span class="sc">*</span><span class="dv">100</span>,<span class="st">")"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">c3=</span> <span class="fu">paste0</span>(value_3<span class="sc">*</span><span class="dv">100</span>,<span class="st">" ("</span>,se_3<span class="sc">*</span><span class="dv">100</span>,<span class="st">")"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">c4=</span> <span class="fu">paste0</span>(value_4<span class="sc">*</span><span class="dv">100</span>,<span class="st">" ("</span>,se_4<span class="sc">*</span><span class="dv">100</span>,<span class="st">")"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">c5=</span> <span class="fu">paste0</span>(value_5<span class="sc">*</span><span class="dv">100</span>,<span class="st">" ("</span>,se_5<span class="sc">*</span><span class="dv">100</span>,<span class="st">")"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Manifest.variables, names, <span class="fu">paste0</span>(<span class="st">"c"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>))</span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a><span class="co">#https://datascience.stackexchange.com/questions/40632/how-do-i-use-the-model-generated-by-the-r-package-polca-to-classify-new-data-as</span></span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a><span class="co">#no sale, tira errores por el poLCAparallel</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">#https://cran.r-project.org/web/packages/flexmix/vignettes/regression-examples.pdf</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co">#https://cran.r-project.org/web/packages/flexmix/vignettes/mixture-regressions.pdf</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="co">#https://cran.r-project.org/web/packages/flexmix/vignettes/bootstrapping.pdf</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(flexmix)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="co">#2023-</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>mydata_preds3_reg<span class="ot">&lt;-</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  mydata_preds3 <span class="sc">%&gt;%</span> </span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(CAUSAL, EDAD_MUJER_REC, MACROZONA, HITO1_EDAD_GEST_SEM_REC, PREV_TRAMO_REC, PAIS_ORIGEN_REC) <span class="sc">%&gt;%</span> </span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">success=</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(outcome)<span class="sc">-</span><span class="dv">1</span>, <span class="at">na.rm=</span>T),<span class="at">total=</span> <span class="fu">n</span>(),<span class="at">failure=</span> total<span class="sc">-</span> success) <span class="sc">%&gt;%</span> </span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>    data.table<span class="sc">::</span><span class="fu">data.table</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>()</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a><span class="co">#table_homolog</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(flexmix)</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a><span class="co">#t. The general form is y~x|g where y is the response, x the set of predictors and g an optional grouping factor for repeated measurements.</span></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a><span class="co"># k= Number of clusters (not needed if cluster is specified).</span></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2125</span>)</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>flexmix_fit <span class="ot">&lt;-</span> <span class="fu">stepFlexmix</span>(<span class="fu">cbind</span>(success, failure) <span class="sc">~</span> CAUSAL<span class="sc">+</span> EDAD_MUJER_REC<span class="sc">+</span> MACROZONA<span class="sc">+</span> HITO1_EDAD_GEST_SEM_REC<span class="sc">+</span> PREV_TRAMO_REC<span class="sc">+</span> PAIS_ORIGEN_REC, </span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span>  mydata_preds3_reg,</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">model =</span> <span class="fu">FLXMRglmfix</span>(<span class="at">family =</span> <span class="st">"binomial"</span>),</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, </span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">nrep =</span> <span class="fl">2.5e3</span>, <span class="co">#1.5? probar</span></span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">list</span>(<span class="at">iter =</span> <span class="fl">5e4</span>, <span class="at">tol =</span> <span class="fl">1e-8</span>) <span class="co">#, minprior = 0.2 not recommended</span></span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a><span class="fu">try</span>(<span class="fu">getModel</span>(ArtEx.fit, <span class="st">"BIC"</span>))</span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a><span class="fu">getModel</span>(flexmix_fit, <span class="st">"BIC"</span>)</span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="st">"Modelo XXX, mejor ajuste. "</span>)</span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a><span class="co">#predict latent class membership</span></span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">clusters</span>(fit)</span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(predictions)</span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a><span class="co">#posterior probabilities</span></span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a>posterior_probs <span class="ot">&lt;-</span> <span class="fu">posterior</span>(fit)</span>
<span id="cb61-35"><a href="#cb61-35" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(posterior_probs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
</section>
</section>
<section id="información-de-la-sesión" class="level1">
<h1>Información de la sesión</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(tidyverse)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>sesion_info <span class="ot">&lt;-</span> devtools<span class="sc">::</span><span class="fu">session_info</span>()</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>(sesion_info<span class="sc">$</span>packages),</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(package, loadedversion, source)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="at">filter =</span> <span class="st">'top'</span>, <span class="at">colnames =</span> <span class="fu">c</span>(<span class="st">'Row number'</span> <span class="ot">=</span><span class="dv">1</span>,<span class="st">'Variable'</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">'Percentage'</span><span class="ot">=</span> <span class="dv">3</span>),</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">caption =</span> htmltools<span class="sc">::</span>tags<span class="sc">$</span><span class="fu">caption</span>(</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">style =</span> <span class="st">'caption-side: top; text-align: left;'</span>,</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">''</span>, htmltools<span class="sc">::</span><span class="fu">em</span>(<span class="st">'Packages'</span>)),</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">options=</span><span class="fu">list</span>(</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="at">initComplete =</span> htmlwidgets<span class="sc">::</span><span class="fu">JS</span>(</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"function(settings, json) {"</span>,</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"$(this.api().tables().body()).css({</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="st">            'font-family': 'Helvetica Neue',</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a><span class="st">            'font-size': '50%', </span></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a><span class="st">            'code-inline-font-size': '15%', </span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a><span class="st">            'white-space': 'nowrap',</span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a><span class="st">            'line-height': '0.75em',</span></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a><span class="st">            'min-height': '0.5em'</span></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a><span class="st">            });"</span>,<span class="co">#;</span></span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">"}"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-6f0de0acf61f1acfaa0a" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-6f0de0acf61f1acfaa0a">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption style=\"caption-side: top; text-align: left;\">\n  \n  <em>Packages<\/em>\n<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206"],["admisc","askpass","backports","base64enc","bayestestR","BiocManager","boot","broom","cachem","callr","caret","checkmate","chron","class","cli","cluster","coda","codetools","colorspace","compareGroups","crayon","crosstalk","crul","curl","data.table","datawizard","DBI","devtools","DiagrammeR","DiagrammeRsvg","digest","doParallel","dplyr","ellipsis","emmeans","estimability","evaluate","fansi","farver","fastmap","flextable","fontBitstreamVera","fontLiberation","fontquiver","forcats","foreach","foreign","Formula","fs","future","future.apply","gdtools","generics","gfonts","ggcorrplot","ggeffects","ggplot2","ggrepel","glmnet","globals","glue","gower","gridExtra","gtable","hardhat","HardyWeinberg","haven","here","Hmisc","hms","htmlTable","htmltools","htmlwidgets","httpcode","httpuv","httr","insight","inum","ipred","iterators","janitor","jomo","jsonlite","kableExtra","knitr","labeling","labelled","later","lattice","lava","lazyeval","libcoin","lifecycle","listenv","lme4","lmtest","lubridate","magrittr","MASS","Matrix","memoise","mice","mime","miniUI","minqa","mitml","mitools","ModelMetrics","modelr","multcomp","munsell","mvtnorm","nlme","nloptr","nnet","officer","openssl","pan","parallelly","partykit","performance","pillar","pkgbuild","pkgconfig","pkgload","plotly","plyr","png","poLCA","poLCAParallel","polycor","prettyunits","pROC","processx","prodlim","profvis","progress","promises","ps","purrr","R.methodsS3","R.oo","R.utils","R6","ragg","RColorBrewer","Rcpp","readr","recipes","remotes","renv","reshape2","rio","rlang","rmarkdown","rpart","rprojroot","Rsolnp","rstudioapi","rsvg","rvest","sandwich","scales","scatterplot3d","sessioninfo","shape","shiny","sjlabelled","sjmisc","sjPlot","sjstats","snakecase","stringi","stringr","survey","survival","svglite","systemfonts","tableone","textshaping","TH.data","tibble","tidyr","tidyselect","tidyverse","timechange","timeDate","truncnorm","tzdb","urlchecker","usethis","utf8","uuid","V8","vctrs","viridisLite","visNetwork","webshot","withr","writexl","xfun","xml2","xtable","yaml","zip","zoo"],["0.33","1.2.0","1.4.1","0.1-3","0.13.1","1.30.22","1.3-28","1.0.5","1.0.8","3.7.3","6.0-94","2.2.0","2.3-61","7.3-22","3.6.1","2.1.4","0.19-4","0.2-18","2.1-0","4.7.1","1.5.2","1.2.0","1.4.0","5.0.2","1.14.8","0.9.0","1.1.3","2.4.5","1.0.10","0.1","0.6.33","1.0.17","1.1.3","0.3.2","1.8.8","1.4.1","0.21","1.0.4","2.1.1","1.1.1","0.9.3","0.1.1","0.1.0","0.2.1","1.0.0","1.5.2","0.8-85","1.2-5","1.6.3","1.33.0","1.11.0","0.3.3","0.1.3","0.2.0","0.1.4.1","1.3.1","3.4.3.9000","0.9.3","4.1-8","0.16.2","1.6.2","1.0.1","2.3","0.3.4","1.3.0","1.7.5","2.5.3","1.0.1","5.1-1","1.1.3","2.4.1","0.5.6","1.6.2","0.3.0","1.6.11","1.4.7","0.19.5","1.0-5","0.9-14","1.0.14","2.2.0","2.7-6","1.8.7","1.3.4","1.44","0.4.3","2.12.0","1.3.1","0.21-8","1.7.2.1","0.2.2","1.0-9","1.0.3","0.9.0","1.1-34","0.9-40","1.9.2","2.0.3","7.3-60","1.6-1.1","2.0.1","3.16.0","0.12","0.1.1.1","1.2.6","0.4-5","2.4","1.2.2.2","0.1.11","1.4-25","0.5.0","1.2-3","3.1-163","2.0.3","7.3-19","0.6.2","2.1.0","1.9","1.36.0","1.2-20","0.10.5","1.9.0","1.4.2","2.0.3","1.3.2.1","4.10.2","1.8.8","0.1-8","1.6.0.1","1.1.0","0.8-1","1.1.1","1.18.4","3.8.2","2023.08.28","0.3.8","1.2.2","1.2.1","1.7.5","1.0.2","1.8.2","1.25.0","2.12.2","2.5.1","1.2.5","1.1-3","1.0.11","2.1.4","1.0.8","2.4.2.1","1.0.3","1.4.4","1.0.1","1.1.1","2.25","4.1.19","2.0.3","1.16","0.15.0","2.4.0","1.0.3","3.0-2","1.2.1","0.3-44","1.2.2","1.4.6","1.7.5","1.2.0","2.8.9","2.8.15","0.18.2","0.11.1","1.7.12","1.5.0","4.2-1","3.5-7","2.1.1","1.0.4","0.13.2","0.3.6","1.1-2","3.2.1","1.3.0","1.2.0","2.0.0","0.2.0","4022.108","1.0-9","0.4.0","1.0.1","2.2.2","1.2.3","1.1-1","4.3.3","0.6.3","0.4.2","2.1.2","0.5.5","2.5.0","1.4.2","0.40","1.3.5","1.8-4","2.3.7","2.3.0","1.8-12"],["CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.0)","CRAN (R 4.2.0)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.2)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.2)","CRAN (R 4.2.3)","CRAN (R 4.2.2)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.1)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.0)","CRAN (R 4.2.0)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.2)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","Github (tidyverse/ggplot2@de7bad63c96a009c34285c21883b704674ceaae1)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.2)","CRAN (R 4.2.3)","CRAN (R 4.2.2)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.0)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.2)","CRAN (R 4.2.3)","Github (QMUL/poLCAParallel@80bc8a20d23e9fc436eceb4c4a07e3d4a4f65e77)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.2)","CRAN (R 4.2.2)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.0)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.2)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.0)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.2)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)","CRAN (R 4.2.3)"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Row number<\/th>\n      <th>Variable<\/th>\n      <th>Percentage<\/th>\n      <th>source<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"initComplete":"function(settings, json) {\n$(this.api().tables().body()).css({\n            'font-family': 'Helvetica Neue',\n            'font-size': '50%', \n            'code-inline-font-size': '15%', \n            'white-space': 'nowrap',\n            'line-height': '0.75em',\n            'min-height': '0.5em'\n            });\n}","columnDefs":[],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":["options.initComplete"],"jsHooks":[]}</script>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>